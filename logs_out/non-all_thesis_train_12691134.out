================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
ðŸ“‹ BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_non_constraint_da

âš™ï¸  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

ðŸ—ï¸  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 32
  Latent Dimension: 8
  Contrastive Layer Filters: 8

ðŸ“Š LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 1.0
  Domain Adaptation Loss: 1.0
  Pseudo Label Loss: 0.5

ðŸ”„ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: True
  Use AttentionPool2d in Discriminators: True
  Pseudo Label Weight: 0.5

ðŸŽ¯ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

ðŸ“ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_camera/SMOKE5K-full/non_constraint
  Pretrained Weights: None
  Model Save Path: models/thesis/E3/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_non_constraint_da

âœ… VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  ðŸ“Š Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

ðŸ”€ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

ðŸ”„ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
æºåŸŸè®­ç»ƒé›†: 1264 batches (full dataset)
Total dataset size: 4242
Training set size: 3393
Validation set size: 849
ç›®æ ‡åŸŸè®­ç»ƒé›†: 848 batches
ç›®æ ‡åŸŸéªŒè¯é›†: 212 batches
æž„å»ºæ¨¡åž‹...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
Created save directory: models/thesis/E3/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_non_constraint_da
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-28 04:28:52.803714 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 4.1020, Src Seg Loss: 1.3548, Tgt Seg Loss: 1.4796, Contrastive Loss: 0.2975, Domain Loss: 0.6969
2025-06-28 04:31:45.402594 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.6131, Src Seg Loss: 1.2829, Tgt Seg Loss: 1.1643, Contrastive Loss: 1.4925, Domain Loss: 0.5695
2025-06-28 04:34:37.294170 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 3.2117, Src Seg Loss: 1.0608, Tgt Seg Loss: 0.9897, Contrastive Loss: 0.2263, Domain Loss: 0.4347
2025-06-28 04:37:28.557610 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 3.0301, Src Seg Loss: 0.7877, Tgt Seg Loss: 1.0571, Contrastive Loss: 0.2335, Domain Loss: 0.5474
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0244
  IoU: 0.3342
  F1-Score: 0.5010
  Precision: 0.5973
  Recall: 0.4314
  Accuracy: 0.9615
New best model saved! Validation loss: 1.0244
  Corresponding target validation IoU: 0.3342
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-28 04:40:28.318635 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 3.2940, Src Seg Loss: 0.9577, Tgt Seg Loss: 0.9430, Contrastive Loss: 0.6433, Domain Loss: 0.4337
2025-06-28 04:43:20.508920 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 3.0885, Src Seg Loss: 0.6835, Tgt Seg Loss: 1.0063, Contrastive Loss: 0.4694, Domain Loss: 0.3421
2025-06-28 04:46:13.496027 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 3.0397, Src Seg Loss: 0.6989, Tgt Seg Loss: 0.8305, Contrastive Loss: 0.5944, Domain Loss: 0.3960
2025-06-28 04:49:05.461731 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 2.9078, Src Seg Loss: 0.7004, Tgt Seg Loss: 0.7967, Contrastive Loss: 0.9343, Domain Loss: 0.4754
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9419
  IoU: 0.4116
  F1-Score: 0.5831
  Precision: 0.5763
  Recall: 0.5901
  Accuracy: 0.9622
New best model saved! Validation loss: 0.9419
  Corresponding target validation IoU: 0.4116
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-28 04:52:06.142564 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 3.0619, Src Seg Loss: 0.7101, Tgt Seg Loss: 0.6347, Contrastive Loss: 0.3975, Domain Loss: 0.3713
2025-06-28 04:54:58.389503 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 3.0848, Src Seg Loss: 0.6826, Tgt Seg Loss: 0.7301, Contrastive Loss: 0.6226, Domain Loss: 0.6487
2025-06-28 04:57:50.385806 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 3.0055, Src Seg Loss: 0.6884, Tgt Seg Loss: 0.8643, Contrastive Loss: 0.5293, Domain Loss: 0.6033
2025-06-28 05:00:42.424517 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 2.7923, Src Seg Loss: 0.5042, Tgt Seg Loss: 0.8418, Contrastive Loss: 0.3578, Domain Loss: 0.5943
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8446
  IoU: 0.4403
  F1-Score: 0.6114
  Precision: 0.5821
  Recall: 0.6438
  Accuracy: 0.9633
New best model saved! Validation loss: 0.8446
  Corresponding target validation IoU: 0.4403
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-28 05:03:43.877511 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 2.7051, Src Seg Loss: 0.5836, Tgt Seg Loss: 0.8152, Contrastive Loss: 0.3080, Domain Loss: 0.5462
2025-06-28 05:06:35.905031 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 2.8402, Src Seg Loss: 0.6092, Tgt Seg Loss: 0.7197, Contrastive Loss: 0.2717, Domain Loss: 0.4830
2025-06-28 05:09:28.013391 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 3.0852, Src Seg Loss: 0.7836, Tgt Seg Loss: 0.7216, Contrastive Loss: 0.7032, Domain Loss: 0.5491
2025-06-28 05:12:20.651552 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 3.1385, Src Seg Loss: 0.6584, Tgt Seg Loss: 0.6160, Contrastive Loss: 0.7443, Domain Loss: 0.7036
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0954
  IoU: 0.4497
  F1-Score: 0.6204
  Precision: 0.6263
  Recall: 0.6146
  Accuracy: 0.9663
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-28 05:15:21.596118 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 3.0404, Src Seg Loss: 0.5629, Tgt Seg Loss: 0.6367, Contrastive Loss: 0.7198, Domain Loss: 0.6281
2025-06-28 05:18:15.938106 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 3.1766, Src Seg Loss: 0.5148, Tgt Seg Loss: 0.7352, Contrastive Loss: 0.7511, Domain Loss: 0.7033
2025-06-28 05:21:08.814498 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 3.0018, Src Seg Loss: 0.4660, Tgt Seg Loss: 0.6748, Contrastive Loss: 0.5982, Domain Loss: 0.4251
2025-06-28 05:24:01.781121 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 2.6809, Src Seg Loss: 0.5375, Tgt Seg Loss: 0.5144, Contrastive Loss: 0.2843, Domain Loss: 0.4681
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8392
  IoU: 0.4678
  F1-Score: 0.6374
  Precision: 0.6265
  Recall: 0.6487
  Accuracy: 0.9669
New best model saved! Validation loss: 0.8392
  Corresponding target validation IoU: 0.4678
Checkpoint saved at epoch 5: checkpoint_epoch_005.pth
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-28 05:27:02.908198 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 2.9381, Src Seg Loss: 0.4225, Tgt Seg Loss: 0.6082, Contrastive Loss: 0.5627, Domain Loss: 0.5485
2025-06-28 05:29:56.050135 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 3.0591, Src Seg Loss: 0.4099, Tgt Seg Loss: 0.4961, Contrastive Loss: 0.6814, Domain Loss: 0.6096
2025-06-28 05:32:50.410535 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 2.8122, Src Seg Loss: 0.5279, Tgt Seg Loss: 0.5277, Contrastive Loss: 0.3301, Domain Loss: 0.6457
2025-06-28 05:35:43.705409 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 2.8613, Src Seg Loss: 0.6469, Tgt Seg Loss: 0.6867, Contrastive Loss: 0.5238, Domain Loss: 0.6849
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8374
  IoU: 0.4717
  F1-Score: 0.6410
  Precision: 0.6911
  Recall: 0.5978
  Accuracy: 0.9700
New best model saved! Validation loss: 0.8374
  Corresponding target validation IoU: 0.4717
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-28 05:38:45.263844 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 2.9481, Src Seg Loss: 0.5606, Tgt Seg Loss: 0.4492, Contrastive Loss: 0.6412, Domain Loss: 0.6208
2025-06-28 05:41:38.552369 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 2.4293, Src Seg Loss: 0.4568, Tgt Seg Loss: 0.5441, Contrastive Loss: 0.0253, Domain Loss: 0.5854
2025-06-28 05:44:31.746781 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 2.4905, Src Seg Loss: 0.4898, Tgt Seg Loss: 0.4670, Contrastive Loss: 0.1546, Domain Loss: 0.5132
2025-06-28 05:47:25.069780 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 2.4518, Src Seg Loss: 0.4258, Tgt Seg Loss: 0.4612, Contrastive Loss: 0.1360, Domain Loss: 0.4938
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7740
  IoU: 0.5095
  F1-Score: 0.6751
  Precision: 0.6626
  Recall: 0.6880
  Accuracy: 0.9703
New best model saved! Validation loss: 0.7740
  Corresponding target validation IoU: 0.5095
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-28 05:50:27.716916 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 2.5913, Src Seg Loss: 0.6892, Tgt Seg Loss: 0.4931, Contrastive Loss: 0.3220, Domain Loss: 0.6414
2025-06-28 05:53:21.036371 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 2.6363, Src Seg Loss: 0.5381, Tgt Seg Loss: 0.5209, Contrastive Loss: 0.4660, Domain Loss: 0.5316
2025-06-28 05:56:14.695602 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 2.6708, Src Seg Loss: 0.4916, Tgt Seg Loss: 0.5335, Contrastive Loss: 0.3989, Domain Loss: 0.6099
2025-06-28 05:59:08.168240 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 2.8578, Src Seg Loss: 0.5295, Tgt Seg Loss: 0.4569, Contrastive Loss: 0.8114, Domain Loss: 0.4631
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8018
  IoU: 0.4982
  F1-Score: 0.6651
  Precision: 0.7049
  Recall: 0.6296
  Accuracy: 0.9716
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-28 06:02:09.229922 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 2.5917, Src Seg Loss: 0.5423, Tgt Seg Loss: 0.4616, Contrastive Loss: 0.3107, Domain Loss: 0.5483
2025-06-28 06:05:04.313267 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 2.6021, Src Seg Loss: 0.2604, Tgt Seg Loss: 0.5830, Contrastive Loss: 0.5485, Domain Loss: 0.7817
2025-06-28 06:07:57.429664 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 2.8389, Src Seg Loss: 0.6552, Tgt Seg Loss: 0.4330, Contrastive Loss: 0.2244, Domain Loss: 0.6232
2025-06-28 06:10:50.506367 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 2.8258, Src Seg Loss: 0.4345, Tgt Seg Loss: 0.4178, Contrastive Loss: 0.4868, Domain Loss: 0.6808
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7805
  IoU: 0.5099
  F1-Score: 0.6754
  Precision: 0.7167
  Recall: 0.6386
  Accuracy: 0.9725
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-28 06:13:51.377298 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 2.8698, Src Seg Loss: 0.4819, Tgt Seg Loss: 0.3958, Contrastive Loss: 0.5542, Domain Loss: 0.6215
2025-06-28 06:16:44.726197 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 2.9399, Src Seg Loss: 0.4820, Tgt Seg Loss: 0.4030, Contrastive Loss: 0.5497, Domain Loss: 0.5987
2025-06-28 06:19:39.310624 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 2.2951, Src Seg Loss: 0.3980, Tgt Seg Loss: 0.4349, Contrastive Loss: 0.0000, Domain Loss: 0.7873
2025-06-28 06:22:32.387756 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 2.3448, Src Seg Loss: 0.4000, Tgt Seg Loss: 0.4246, Contrastive Loss: 0.0340, Domain Loss: 0.7917
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8542
  IoU: 0.4681
  F1-Score: 0.6377
  Precision: 0.7588
  Recall: 0.5500
  Accuracy: 0.9720
Checkpoint saved at epoch 10: checkpoint_epoch_010.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-28 06:25:33.630561 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 2.3485, Src Seg Loss: 0.3802, Tgt Seg Loss: 0.3269, Contrastive Loss: 0.0757, Domain Loss: 0.6528
2025-06-28 06:28:26.707969 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.3066, Src Seg Loss: 0.4077, Tgt Seg Loss: 0.4735, Contrastive Loss: 0.0664, Domain Loss: 0.6958
2025-06-28 06:31:20.180607 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.3922, Src Seg Loss: 0.3465, Tgt Seg Loss: 0.6021, Contrastive Loss: 0.0678, Domain Loss: 0.6393
2025-06-28 06:34:13.581889 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.4340, Src Seg Loss: 0.5059, Tgt Seg Loss: 0.3009, Contrastive Loss: 0.1411, Domain Loss: 0.6535
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9733
  IoU: 0.4093
  F1-Score: 0.5808
  Precision: 0.7818
  Recall: 0.4621
  Accuracy: 0.9701
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-28 06:37:16.017519 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.4405, Src Seg Loss: 0.3382, Tgt Seg Loss: 0.3453, Contrastive Loss: 0.0823, Domain Loss: 0.6871
2025-06-28 06:40:08.828507 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.4207, Src Seg Loss: 0.4118, Tgt Seg Loss: 0.3520, Contrastive Loss: 0.2239, Domain Loss: 0.7839
2025-06-28 06:43:01.933433 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 2.6929, Src Seg Loss: 0.3972, Tgt Seg Loss: 0.4282, Contrastive Loss: 0.3346, Domain Loss: 0.6407
2025-06-28 06:45:55.205343 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 2.7707, Src Seg Loss: 0.4435, Tgt Seg Loss: 0.4218, Contrastive Loss: 0.5138, Domain Loss: 0.5897
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7999
  IoU: 0.5195
  F1-Score: 0.6838
  Precision: 0.6875
  Recall: 0.6801
  Accuracy: 0.9718
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-28 06:48:56.672277 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 2.7041, Src Seg Loss: 0.4894, Tgt Seg Loss: 0.3207, Contrastive Loss: 0.4362, Domain Loss: 0.6741
2025-06-28 06:51:51.347872 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 2.7355, Src Seg Loss: 0.4014, Tgt Seg Loss: 0.4560, Contrastive Loss: 0.3535, Domain Loss: 0.6229
2025-06-28 06:54:44.738359 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 2.6440, Src Seg Loss: 0.3347, Tgt Seg Loss: 0.3393, Contrastive Loss: 0.4698, Domain Loss: 0.6372
2025-06-28 06:57:38.385150 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.8839, Src Seg Loss: 0.3814, Tgt Seg Loss: 0.4394, Contrastive Loss: 0.6895, Domain Loss: 0.6782
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8316
  IoU: 0.4979
  F1-Score: 0.6648
  Precision: 0.6983
  Recall: 0.6344
  Accuracy: 0.9713
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-28 07:00:39.355392 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.5544, Src Seg Loss: 0.3765, Tgt Seg Loss: 0.4054, Contrastive Loss: 0.2494, Domain Loss: 0.7610
2025-06-28 07:03:32.946415 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.8343, Src Seg Loss: 0.2502, Tgt Seg Loss: 0.4667, Contrastive Loss: 0.5377, Domain Loss: 0.7727
2025-06-28 07:06:27.773324 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.7331, Src Seg Loss: 0.3229, Tgt Seg Loss: 0.3929, Contrastive Loss: 0.1365, Domain Loss: 0.6727
2025-06-28 07:09:20.997237 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.4045, Src Seg Loss: 0.3985, Tgt Seg Loss: 0.4373, Contrastive Loss: 0.0885, Domain Loss: 0.7060
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8560
  IoU: 0.4894
  F1-Score: 0.6571
  Precision: 0.7624
  Recall: 0.5774
  Accuracy: 0.9730
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-28 07:12:22.272866 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.3681, Src Seg Loss: 0.4319, Tgt Seg Loss: 0.4283, Contrastive Loss: 0.0681, Domain Loss: 0.6683
2025-06-28 07:15:15.899048 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.5570, Src Seg Loss: 0.3582, Tgt Seg Loss: 0.3824, Contrastive Loss: 0.2594, Domain Loss: 0.6785
2025-06-28 07:18:09.256892 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 2.5955, Src Seg Loss: 0.3107, Tgt Seg Loss: 0.4389, Contrastive Loss: 0.3052, Domain Loss: 0.7928
2025-06-28 07:21:02.530019 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.2245, Src Seg Loss: 0.3343, Tgt Seg Loss: 0.3654, Contrastive Loss: 0.0243, Domain Loss: 0.8609
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8094
  IoU: 0.5226
  F1-Score: 0.6864
  Precision: 0.7329
  Recall: 0.6454
  Accuracy: 0.9735
Checkpoint saved at epoch 15: checkpoint_epoch_015.pth
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-28 07:24:05.727862 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.4927, Src Seg Loss: 0.3424, Tgt Seg Loss: 0.2860, Contrastive Loss: 0.3201, Domain Loss: 0.6298
2025-06-28 07:26:59.100676 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 2.5356, Src Seg Loss: 0.3285, Tgt Seg Loss: 0.3056, Contrastive Loss: 0.2714, Domain Loss: 0.6684
2025-06-28 07:29:52.515718 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 2.3526, Src Seg Loss: 0.4248, Tgt Seg Loss: 0.5086, Contrastive Loss: 0.2189, Domain Loss: 0.7207
2025-06-28 07:32:46.155705 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.5929, Src Seg Loss: 0.2978, Tgt Seg Loss: 0.4600, Contrastive Loss: 0.4395, Domain Loss: 0.7090
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8289
  IoU: 0.5084
  F1-Score: 0.6741
  Precision: 0.7177
  Recall: 0.6356
  Accuracy: 0.9724
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-28 07:35:47.181002 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.8574, Src Seg Loss: 0.2396, Tgt Seg Loss: 0.3447, Contrastive Loss: 0.6758, Domain Loss: 0.6485
2025-06-28 07:38:42.391081 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.9234, Src Seg Loss: 0.3537, Tgt Seg Loss: 0.2629, Contrastive Loss: 0.7947, Domain Loss: 0.7417
2025-06-28 07:41:36.657732 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.8967, Src Seg Loss: 0.3480, Tgt Seg Loss: 0.3614, Contrastive Loss: 0.7283, Domain Loss: 0.6413
2025-06-28 07:44:30.577480 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.9263, Src Seg Loss: 0.3447, Tgt Seg Loss: 0.4120, Contrastive Loss: 0.7014, Domain Loss: 0.7013
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8777
  IoU: 0.4728
  F1-Score: 0.6420
  Precision: 0.7333
  Recall: 0.5709
  Accuracy: 0.9714
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-28 07:47:32.118121 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.8693, Src Seg Loss: 0.2440, Tgt Seg Loss: 0.3394, Contrastive Loss: 0.8047, Domain Loss: 0.6543
2025-06-28 07:50:25.755703 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 2.8483, Src Seg Loss: 0.4920, Tgt Seg Loss: 0.3319, Contrastive Loss: 0.7316, Domain Loss: 0.6994
2025-06-28 07:53:20.866876 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.2903, Src Seg Loss: 0.3748, Tgt Seg Loss: 0.3177, Contrastive Loss: 0.1608, Domain Loss: 0.7050
2025-06-28 07:56:14.743853 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.5622, Src Seg Loss: 0.4519, Tgt Seg Loss: 0.3322, Contrastive Loss: 0.2698, Domain Loss: 0.6795
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8317
  IoU: 0.5163
  F1-Score: 0.6810
  Precision: 0.7274
  Recall: 0.6401
  Accuracy: 0.9731
--------------------Epoch: 19/100--------------------
Learning Rate: 5e-05
2025-06-28 07:59:15.962186 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 2.5886, Src Seg Loss: 0.3322, Tgt Seg Loss: 0.3484, Contrastive Loss: 0.5140, Domain Loss: 0.7137
2025-06-28 08:02:09.007468 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 2.5769, Src Seg Loss: 0.3707, Tgt Seg Loss: 0.3719, Contrastive Loss: 0.2766, Domain Loss: 0.7631
2025-06-28 08:05:02.066941 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 2.6001, Src Seg Loss: 0.3066, Tgt Seg Loss: 0.2613, Contrastive Loss: 0.3608, Domain Loss: 0.7000
2025-06-28 08:07:56.493223 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 2.5748, Src Seg Loss: 0.2183, Tgt Seg Loss: 0.2762, Contrastive Loss: 0.5245, Domain Loss: 0.7099
Epoch 19 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8529
  IoU: 0.4991
  F1-Score: 0.6659
  Precision: 0.7675
  Recall: 0.5880
  Accuracy: 0.9735
--------------------Epoch: 20/100--------------------
Learning Rate: 5e-05
2025-06-28 08:10:57.685882 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.6316, Src Seg Loss: 0.2612, Tgt Seg Loss: 0.2897, Contrastive Loss: 0.5382, Domain Loss: 0.7344
2025-06-28 08:13:50.723823 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 2.3929, Src Seg Loss: 0.2533, Tgt Seg Loss: 0.3137, Contrastive Loss: 0.2948, Domain Loss: 0.7012
2025-06-28 08:16:43.737221 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 2.3543, Src Seg Loss: 0.3183, Tgt Seg Loss: 0.3571, Contrastive Loss: 0.4162, Domain Loss: 0.6700
2025-06-28 08:19:37.216907 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 2.5891, Src Seg Loss: 0.2346, Tgt Seg Loss: 0.2511, Contrastive Loss: 0.4407, Domain Loss: 0.7114
Epoch 20 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8262
  IoU: 0.5305
  F1-Score: 0.6932
  Precision: 0.7321
  Recall: 0.6583
  Accuracy: 0.9739
Learning rate adjusted based on validation loss: 0.000050 -> 0.000040
Checkpoint saved at epoch 20: checkpoint_epoch_020.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 4e-05
2025-06-28 08:22:38.723825 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 2.5471, Src Seg Loss: 0.2135, Tgt Seg Loss: 0.2634, Contrastive Loss: 0.4572, Domain Loss: 0.7484
2025-06-28 08:25:34.399144 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 2.6132, Src Seg Loss: 0.3405, Tgt Seg Loss: 0.2599, Contrastive Loss: 0.4303, Domain Loss: 0.6576
2025-06-28 08:28:28.579653 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 2.6579, Src Seg Loss: 0.2420, Tgt Seg Loss: 0.3318, Contrastive Loss: 0.5550, Domain Loss: 0.7296
2025-06-28 08:31:22.610522 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 2.6727, Src Seg Loss: 0.3123, Tgt Seg Loss: 0.2285, Contrastive Loss: 0.6082, Domain Loss: 0.6169
Epoch 21 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8709
  IoU: 0.5111
  F1-Score: 0.6764
  Precision: 0.7857
  Recall: 0.5938
  Accuracy: 0.9745
--------------------Epoch: 22/100--------------------
Learning Rate: 4e-05
2025-06-28 08:34:24.110060 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 2.6473, Src Seg Loss: 0.3877, Tgt Seg Loss: 0.3269, Contrastive Loss: 0.4937, Domain Loss: 0.7181
2025-06-28 08:37:17.551782 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 2.5573, Src Seg Loss: 0.2150, Tgt Seg Loss: 0.2637, Contrastive Loss: 0.5050, Domain Loss: 0.6930
2025-06-28 08:40:12.591197 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 2.5647, Src Seg Loss: 0.3615, Tgt Seg Loss: 0.2221, Contrastive Loss: 0.5270, Domain Loss: 0.6575
2025-06-28 08:43:06.071968 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.5145, Src Seg Loss: 0.2111, Tgt Seg Loss: 0.2955, Contrastive Loss: 0.4282, Domain Loss: 0.7344
Epoch 22 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8585
  IoU: 0.5128
  F1-Score: 0.6779
  Precision: 0.7545
  Recall: 0.6154
  Accuracy: 0.9738
--------------------Epoch: 23/100--------------------
Learning Rate: 4e-05
2025-06-28 08:46:07.716924 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 2.3437, Src Seg Loss: 0.1919, Tgt Seg Loss: 0.2239, Contrastive Loss: 0.2542, Domain Loss: 0.7156
2025-06-28 08:49:01.713062 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 2.2068, Src Seg Loss: 0.4936, Tgt Seg Loss: 0.2100, Contrastive Loss: 0.0942, Domain Loss: 0.5371
2025-06-28 08:51:55.595927 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 2.2958, Src Seg Loss: 0.2562, Tgt Seg Loss: 0.1682, Contrastive Loss: 0.1045, Domain Loss: 0.6675
2025-06-28 08:54:49.824081 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 2.4386, Src Seg Loss: 0.3105, Tgt Seg Loss: 0.2317, Contrastive Loss: 0.3429, Domain Loss: 0.7129
Epoch 23 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8344
  IoU: 0.5233
  F1-Score: 0.6870
  Precision: 0.7448
  Recall: 0.6376
  Accuracy: 0.9739
--------------------Epoch: 24/100--------------------
Learning Rate: 4e-05
2025-06-28 08:57:52.850102 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 2.4520, Src Seg Loss: 0.2518, Tgt Seg Loss: 0.3156, Contrastive Loss: 0.3814, Domain Loss: 0.7445
2025-06-28 09:00:46.683074 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 2.3790, Src Seg Loss: 0.2848, Tgt Seg Loss: 0.3147, Contrastive Loss: 0.1714, Domain Loss: 0.6774
2025-06-28 09:03:40.577013 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 2.2939, Src Seg Loss: 0.3529, Tgt Seg Loss: 0.2422, Contrastive Loss: 0.2038, Domain Loss: 0.6692
2025-06-28 09:06:34.336586 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 2.5527, Src Seg Loss: 0.3022, Tgt Seg Loss: 0.3196, Contrastive Loss: 0.3793, Domain Loss: 0.6915
Epoch 24 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8357
  IoU: 0.5224
  F1-Score: 0.6863
  Precision: 0.7224
  Recall: 0.6536
  Accuracy: 0.9732
--------------------Epoch: 25/100--------------------
Learning Rate: 4e-05
2025-06-28 09:09:35.946954 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 2.5014, Src Seg Loss: 0.3088, Tgt Seg Loss: 0.2763, Contrastive Loss: 0.5303, Domain Loss: 0.7342
2025-06-28 09:12:31.200408 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 2.5259, Src Seg Loss: 0.2599, Tgt Seg Loss: 0.1819, Contrastive Loss: 0.4701, Domain Loss: 0.7117
2025-06-28 09:15:25.085900 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 2.4451, Src Seg Loss: 0.1431, Tgt Seg Loss: 0.2234, Contrastive Loss: 0.2711, Domain Loss: 0.7297
2025-06-28 09:18:18.906563 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 2.4715, Src Seg Loss: 0.3787, Tgt Seg Loss: 0.2325, Contrastive Loss: 0.3783, Domain Loss: 0.6922
Epoch 25 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8033
  IoU: 0.5361
  F1-Score: 0.6980
  Precision: 0.7093
  Recall: 0.6871
  Accuracy: 0.9733
Checkpoint saved at epoch 25: checkpoint_epoch_025.pth
--------------------Epoch: 26/100--------------------
Learning Rate: 4e-05
2025-06-28 09:21:20.702098 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 2.3683, Src Seg Loss: 0.1604, Tgt Seg Loss: 0.1942, Contrastive Loss: 0.2833, Domain Loss: 0.7315
2025-06-28 09:24:14.500535 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 2.3758, Src Seg Loss: 0.2352, Tgt Seg Loss: 0.2311, Contrastive Loss: 0.3823, Domain Loss: 0.7622
2025-06-28 09:27:10.708271 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 2.5648, Src Seg Loss: 0.2654, Tgt Seg Loss: 0.2325, Contrastive Loss: 0.5015, Domain Loss: 0.7211
2025-06-28 09:30:04.064078 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 2.5918, Src Seg Loss: 0.2561, Tgt Seg Loss: 0.3271, Contrastive Loss: 0.5590, Domain Loss: 0.6746
Epoch 26 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8102
  IoU: 0.5360
  F1-Score: 0.6979
  Precision: 0.7257
  Recall: 0.6722
  Accuracy: 0.9739
--------------------Epoch: 27/100--------------------
Learning Rate: 4e-05
2025-06-28 09:33:04.969144 Epoch [027/100], Step [0316/1264] (25%), Total Loss: 2.5312, Src Seg Loss: 0.2295, Tgt Seg Loss: 0.2212, Contrastive Loss: 0.5126, Domain Loss: 0.7085
2025-06-28 09:35:58.064815 Epoch [027/100], Step [0632/1264] (50%), Total Loss: 2.4188, Src Seg Loss: 0.2812, Tgt Seg Loss: 0.1914, Contrastive Loss: 0.4578, Domain Loss: 0.7068
2025-06-28 09:38:51.049545 Epoch [027/100], Step [0948/1264] (75%), Total Loss: 2.4261, Src Seg Loss: 0.2628, Tgt Seg Loss: 0.2583, Contrastive Loss: 0.5088, Domain Loss: 0.7721
2025-06-28 09:41:45.309330 Epoch [027/100], Step [1264/1264] (100%), Total Loss: 2.5002, Src Seg Loss: 0.2531, Tgt Seg Loss: 0.1931, Contrastive Loss: 0.3436, Domain Loss: 0.6757
Epoch 27 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9545
  IoU: 0.5012
  F1-Score: 0.6677
  Precision: 0.8009
  Recall: 0.5725
  Accuracy: 0.9744
--------------------Epoch: 28/100--------------------
Learning Rate: 4e-05
2025-06-28 09:44:47.343608 Epoch [028/100], Step [0316/1264] (25%), Total Loss: 2.5087, Src Seg Loss: 0.2113, Tgt Seg Loss: 0.1991, Contrastive Loss: 0.5204, Domain Loss: 0.7138
2025-06-28 09:47:42.029205 Epoch [028/100], Step [0632/1264] (50%), Total Loss: 2.4838, Src Seg Loss: 0.2121, Tgt Seg Loss: 0.1874, Contrastive Loss: 0.5223, Domain Loss: 0.6900
2025-06-28 09:50:35.679065 Epoch [028/100], Step [0948/1264] (75%), Total Loss: 2.3284, Src Seg Loss: 0.2696, Tgt Seg Loss: 0.1723, Contrastive Loss: 0.3535, Domain Loss: 0.6661
2025-06-28 09:53:29.913010 Epoch [028/100], Step [1264/1264] (100%), Total Loss: 2.3619, Src Seg Loss: 0.2309, Tgt Seg Loss: 0.2070, Contrastive Loss: 0.4776, Domain Loss: 0.6742
Epoch 28 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8199
  IoU: 0.5371
  F1-Score: 0.6989
  Precision: 0.7285
  Recall: 0.6716
  Accuracy: 0.9740
--------------------Epoch: 29/100--------------------
Learning Rate: 4e-05
2025-06-28 09:56:30.849725 Epoch [029/100], Step [0316/1264] (25%), Total Loss: 2.3577, Src Seg Loss: 0.2576, Tgt Seg Loss: 0.2046, Contrastive Loss: 0.4072, Domain Loss: 0.6382
2025-06-28 09:59:26.065292 Epoch [029/100], Step [0632/1264] (50%), Total Loss: 2.4966, Src Seg Loss: 0.2029, Tgt Seg Loss: 0.1766, Contrastive Loss: 0.3265, Domain Loss: 0.6738
2025-06-28 10:02:19.550644 Epoch [029/100], Step [0948/1264] (75%), Total Loss: 2.5769, Src Seg Loss: 0.2907, Tgt Seg Loss: 0.2380, Contrastive Loss: 0.5880, Domain Loss: 0.6859
2025-06-28 10:05:13.450596 Epoch [029/100], Step [1264/1264] (100%), Total Loss: 2.5814, Src Seg Loss: 0.3075, Tgt Seg Loss: 0.2143, Contrastive Loss: 0.5717, Domain Loss: 0.6791
Epoch 29 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9087
  IoU: 0.5129
  F1-Score: 0.6781
  Precision: 0.7826
  Recall: 0.5981
  Accuracy: 0.9745
Early stopping triggered at epoch 29
Best validation loss: 0.7740 achieved at epoch 7

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_camera_SMOKE5K-full_non_constraint (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 0.7740 achieved at epoch 7
Best model saved at: models/thesis/E3/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_non_constraint_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_non_constraint_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12691134
Cluster: snellius
User/Group: ytao/ytao
State: RUNNING
Nodes: 1
Cores per node: 16
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 3-18:40:00 core-walltime
Job Wall-clock time: 05:40:00
Memory Utilized: 0.00 MB
Memory Efficiency: 0.00% of 80.00 GB (80.00 GB/node)
WARNING: Efficiency statistics can only be obtained after the job has ended as seff tool is based on the accounting database data.
