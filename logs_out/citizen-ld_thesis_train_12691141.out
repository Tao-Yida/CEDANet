================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
üìã BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚öôÔ∏è  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

üèóÔ∏è  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 32
  Latent Dimension: 8
  Contrastive Layer Filters: 8

üìä LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 1.0
  Domain Adaptation Loss: 1.0
  Pseudo Label Loss: 0.5

üîÑ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: True
  Use AttentionPool2d in Discriminators: False
  Pseudo Label Weight: 0.5

üéØ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

üìÅ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_camera/SMOKE5K-full/citizen_constraint
  Pretrained Weights: None
  Model Save Path: models/thesis/ablation-ld/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚úÖ VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  üìä Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

üîÄ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

üîÑ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
Ê∫êÂüüËÆ≠ÁªÉÈõÜ: 1264 batches (full dataset)
Total dataset size: 4326
Training set size: 3460
Validation set size: 866
ÁõÆÊ†áÂüüËÆ≠ÁªÉÈõÜ: 865 batches
ÁõÆÊ†áÂüüÈ™åËØÅÈõÜ: 216 batches
ÊûÑÂª∫Ê®°Âûã...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
Created save directory: models/thesis/ablation-ld/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-28 04:30:42.273489 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 3.9426, Src Seg Loss: 1.3319, Tgt Seg Loss: 1.3089, Contrastive Loss: 0.1643, Domain Loss: 0.6945
2025-06-28 04:33:32.181100 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.5499, Src Seg Loss: 1.2823, Tgt Seg Loss: 1.0795, Contrastive Loss: 0.2226, Domain Loss: 0.6666
2025-06-28 04:36:24.172230 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 3.4073, Src Seg Loss: 1.0056, Tgt Seg Loss: 1.0233, Contrastive Loss: 0.0782, Domain Loss: 0.6338
2025-06-28 04:39:14.188437 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 3.1667, Src Seg Loss: 0.8332, Tgt Seg Loss: 0.9762, Contrastive Loss: 0.0373, Domain Loss: 0.6434
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0693
  IoU: 0.2400
  F1-Score: 0.3871
  Precision: 0.4255
  Recall: 0.3550
  Accuracy: 0.9734
New best model saved! Validation loss: 1.0693
  Corresponding target validation IoU: 0.2400
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-28 04:42:12.830567 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 3.4477, Src Seg Loss: 1.0251, Tgt Seg Loss: 1.0385, Contrastive Loss: 0.2282, Domain Loss: 0.6312
2025-06-28 04:45:03.881238 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 3.1449, Src Seg Loss: 0.7332, Tgt Seg Loss: 1.0553, Contrastive Loss: 0.1643, Domain Loss: 0.6096
2025-06-28 04:47:55.188212 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 3.1780, Src Seg Loss: 0.9320, Tgt Seg Loss: 1.0668, Contrastive Loss: 0.2378, Domain Loss: 0.6020
2025-06-28 04:50:46.464699 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 2.8612, Src Seg Loss: 1.0438, Tgt Seg Loss: 1.0368, Contrastive Loss: 0.1758, Domain Loss: 0.5908
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 2.1872
  IoU: 0.1641
  F1-Score: 0.2819
  Precision: 0.1931
  Recall: 0.5220
  Accuracy: 0.9371
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-28 04:53:48.178255 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 2.9847, Src Seg Loss: 0.6524, Tgt Seg Loss: 1.1223, Contrastive Loss: 0.1199, Domain Loss: 0.5793
2025-06-28 04:56:38.898054 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 2.8711, Src Seg Loss: 0.8227, Tgt Seg Loss: 0.9817, Contrastive Loss: 0.0602, Domain Loss: 0.6074
2025-06-28 04:59:29.847605 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 2.7641, Src Seg Loss: 0.5889, Tgt Seg Loss: 0.9006, Contrastive Loss: 0.1071, Domain Loss: 0.5941
2025-06-28 05:02:20.664719 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 3.0917, Src Seg Loss: 0.6782, Tgt Seg Loss: 1.0261, Contrastive Loss: 0.3758, Domain Loss: 0.5665
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0459
  IoU: 0.2976
  F1-Score: 0.4586
  Precision: 0.4127
  Recall: 0.5161
  Accuracy: 0.9712
New best model saved! Validation loss: 1.0459
  Corresponding target validation IoU: 0.2976
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-28 05:05:19.820625 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 2.9255, Src Seg Loss: 0.5324, Tgt Seg Loss: 1.0325, Contrastive Loss: 0.2323, Domain Loss: 0.6177
2025-06-28 05:08:12.655877 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 2.9620, Src Seg Loss: 0.5919, Tgt Seg Loss: 0.8476, Contrastive Loss: 0.3123, Domain Loss: 0.6696
2025-06-28 05:11:03.642974 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 2.9112, Src Seg Loss: 0.6174, Tgt Seg Loss: 0.8930, Contrastive Loss: 0.4035, Domain Loss: 0.5730
2025-06-28 05:13:54.788242 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 2.8479, Src Seg Loss: 0.6255, Tgt Seg Loss: 1.0203, Contrastive Loss: 0.2134, Domain Loss: 0.5698
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9668
  IoU: 0.3734
  F1-Score: 0.5437
  Precision: 0.6118
  Recall: 0.4893
  Accuracy: 0.9806
New best model saved! Validation loss: 0.9668
  Corresponding target validation IoU: 0.3734
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-28 05:16:53.713340 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 2.8418, Src Seg Loss: 0.6731, Tgt Seg Loss: 1.0256, Contrastive Loss: 0.1293, Domain Loss: 0.5775
2025-06-28 05:19:44.660356 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 2.7966, Src Seg Loss: 0.6221, Tgt Seg Loss: 0.8086, Contrastive Loss: 0.1911, Domain Loss: 0.7215
2025-06-28 05:22:35.868262 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 2.7890, Src Seg Loss: 0.4862, Tgt Seg Loss: 1.0189, Contrastive Loss: 0.2589, Domain Loss: 0.5811
2025-06-28 05:25:28.162990 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 2.7143, Src Seg Loss: 0.5372, Tgt Seg Loss: 0.9390, Contrastive Loss: 0.0509, Domain Loss: 0.6506
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.1617
  IoU: 0.3053
  F1-Score: 0.4678
  Precision: 0.4714
  Recall: 0.4642
  Accuracy: 0.9750
Checkpoint saved at epoch 5: checkpoint_epoch_005.pth
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-28 05:28:27.320601 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 2.6833, Src Seg Loss: 0.4975, Tgt Seg Loss: 0.8385, Contrastive Loss: 0.2848, Domain Loss: 0.6202
2025-06-28 05:31:18.508115 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 2.7530, Src Seg Loss: 0.4219, Tgt Seg Loss: 0.9164, Contrastive Loss: 0.2364, Domain Loss: 0.6396
2025-06-28 05:34:09.539648 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 2.9319, Src Seg Loss: 0.4534, Tgt Seg Loss: 0.9569, Contrastive Loss: 0.4911, Domain Loss: 0.6535
2025-06-28 05:37:00.746121 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 2.9149, Src Seg Loss: 0.4815, Tgt Seg Loss: 0.9763, Contrastive Loss: 0.4836, Domain Loss: 0.6243
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0695
  IoU: 0.3259
  F1-Score: 0.4916
  Precision: 0.5618
  Recall: 0.4370
  Accuracy: 0.9786
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-28 05:40:01.152297 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 2.6377, Src Seg Loss: 0.4609, Tgt Seg Loss: 0.8738, Contrastive Loss: 0.1928, Domain Loss: 0.6346
2025-06-28 05:42:51.584081 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 2.6175, Src Seg Loss: 0.6504, Tgt Seg Loss: 0.9288, Contrastive Loss: 0.1655, Domain Loss: 0.6166
2025-06-28 05:45:42.344641 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 2.6368, Src Seg Loss: 0.5899, Tgt Seg Loss: 0.8739, Contrastive Loss: 0.1673, Domain Loss: 0.5706
2025-06-28 05:48:33.049676 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 2.8838, Src Seg Loss: 0.3777, Tgt Seg Loss: 0.8860, Contrastive Loss: 0.4038, Domain Loss: 0.5893
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9917
  IoU: 0.3528
  F1-Score: 0.5216
  Precision: 0.4260
  Recall: 0.6726
  Accuracy: 0.9708
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-28 05:51:32.060251 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 2.6835, Src Seg Loss: 0.5254, Tgt Seg Loss: 0.7468, Contrastive Loss: 0.2858, Domain Loss: 0.6242
2025-06-28 05:54:25.016531 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 2.4576, Src Seg Loss: 0.4937, Tgt Seg Loss: 0.6695, Contrastive Loss: 0.0514, Domain Loss: 0.6097
2025-06-28 05:57:16.128454 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 3.0406, Src Seg Loss: 0.2997, Tgt Seg Loss: 0.8891, Contrastive Loss: 0.5067, Domain Loss: 0.5949
2025-06-28 06:00:07.396292 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 2.9245, Src Seg Loss: 0.4744, Tgt Seg Loss: 0.8211, Contrastive Loss: 0.5215, Domain Loss: 0.6135
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9885
  IoU: 0.4294
  F1-Score: 0.6008
  Precision: 0.6198
  Recall: 0.5830
  Accuracy: 0.9817
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-28 06:03:06.826691 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 2.9419, Src Seg Loss: 0.4105, Tgt Seg Loss: 0.6918, Contrastive Loss: 0.4428, Domain Loss: 0.6581
2025-06-28 06:05:58.155593 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 2.5038, Src Seg Loss: 0.5139, Tgt Seg Loss: 0.8727, Contrastive Loss: 0.0911, Domain Loss: 0.5985
2025-06-28 06:08:49.379728 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 2.7831, Src Seg Loss: 0.4218, Tgt Seg Loss: 1.0039, Contrastive Loss: 0.2128, Domain Loss: 0.5576
2025-06-28 06:11:42.100108 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 2.6735, Src Seg Loss: 0.5030, Tgt Seg Loss: 0.7255, Contrastive Loss: 0.3779, Domain Loss: 0.6320
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.1664
  IoU: 0.3500
  F1-Score: 0.5185
  Precision: 0.6017
  Recall: 0.4555
  Accuracy: 0.9800
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-28 06:14:40.461887 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 2.6252, Src Seg Loss: 0.3541, Tgt Seg Loss: 1.0196, Contrastive Loss: 0.2679, Domain Loss: 0.6238
2025-06-28 06:17:31.388906 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 2.7176, Src Seg Loss: 0.3497, Tgt Seg Loss: 0.9219, Contrastive Loss: 0.6034, Domain Loss: 0.6738
2025-06-28 06:20:22.326071 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 2.8418, Src Seg Loss: 0.4894, Tgt Seg Loss: 0.6997, Contrastive Loss: 0.4797, Domain Loss: 0.6101
2025-06-28 06:23:13.403471 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 2.7905, Src Seg Loss: 0.4353, Tgt Seg Loss: 0.8394, Contrastive Loss: 0.3060, Domain Loss: 0.5745
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.1875
  IoU: 0.3283
  F1-Score: 0.4943
  Precision: 0.4300
  Recall: 0.5813
  Accuracy: 0.9718
Checkpoint saved at epoch 10: checkpoint_epoch_010.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-28 06:26:14.188762 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 2.7975, Src Seg Loss: 0.3311, Tgt Seg Loss: 0.8820, Contrastive Loss: 0.5202, Domain Loss: 0.6115
2025-06-28 06:29:05.134848 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.4554, Src Seg Loss: 0.4137, Tgt Seg Loss: 0.8156, Contrastive Loss: 0.0315, Domain Loss: 0.6170
2025-06-28 06:31:56.001671 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.8975, Src Seg Loss: 0.4057, Tgt Seg Loss: 0.7804, Contrastive Loss: 0.6335, Domain Loss: 0.6080
2025-06-28 06:34:46.965559 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.8412, Src Seg Loss: 0.4031, Tgt Seg Loss: 0.7565, Contrastive Loss: 0.5885, Domain Loss: 0.6633
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9683
  IoU: 0.4275
  F1-Score: 0.5989
  Precision: 0.5921
  Recall: 0.6059
  Accuracy: 0.9808
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-28 06:37:45.874131 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.8642, Src Seg Loss: 0.2601, Tgt Seg Loss: 0.8645, Contrastive Loss: 0.6462, Domain Loss: 0.6290
2025-06-28 06:40:38.447577 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.8793, Src Seg Loss: 0.3050, Tgt Seg Loss: 0.6626, Contrastive Loss: 0.6444, Domain Loss: 0.6544
2025-06-28 06:43:29.158759 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 2.9487, Src Seg Loss: 0.3376, Tgt Seg Loss: 1.0123, Contrastive Loss: 0.7094, Domain Loss: 0.6589
2025-06-28 06:46:20.066957 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 3.0670, Src Seg Loss: 0.3308, Tgt Seg Loss: 0.8442, Contrastive Loss: 0.5954, Domain Loss: 0.6505
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0015
  IoU: 0.4470
  F1-Score: 0.6178
  Precision: 0.6406
  Recall: 0.5965
  Accuracy: 0.9825
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-28 06:49:18.983635 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 2.9554, Src Seg Loss: 0.3321, Tgt Seg Loss: 0.6654, Contrastive Loss: 0.7674, Domain Loss: 0.6361
2025-06-28 06:52:09.824143 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 2.8985, Src Seg Loss: 0.6319, Tgt Seg Loss: 0.8463, Contrastive Loss: 0.4170, Domain Loss: 0.6737
2025-06-28 06:55:00.815128 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 2.4442, Src Seg Loss: 0.4415, Tgt Seg Loss: 0.7620, Contrastive Loss: 0.0721, Domain Loss: 0.6426
2025-06-28 06:57:53.176225 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.5261, Src Seg Loss: 0.4345, Tgt Seg Loss: 0.7336, Contrastive Loss: 0.2235, Domain Loss: 0.6330
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9352
  IoU: 0.4722
  F1-Score: 0.6415
  Precision: 0.6411
  Recall: 0.6419
  Accuracy: 0.9830
New best model saved! Validation loss: 0.9352
  Corresponding target validation IoU: 0.4722
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-28 07:00:52.488534 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.6282, Src Seg Loss: 0.3739, Tgt Seg Loss: 0.8899, Contrastive Loss: 0.3222, Domain Loss: 0.6420
2025-06-28 07:03:43.487402 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.7683, Src Seg Loss: 0.4690, Tgt Seg Loss: 0.9068, Contrastive Loss: 0.5372, Domain Loss: 0.6481
2025-06-28 07:06:34.538819 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.5087, Src Seg Loss: 0.4671, Tgt Seg Loss: 0.6286, Contrastive Loss: 0.0672, Domain Loss: 0.6785
2025-06-28 07:09:25.526275 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.3969, Src Seg Loss: 0.3272, Tgt Seg Loss: 0.7957, Contrastive Loss: 0.0087, Domain Loss: 0.7121
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9313
  IoU: 0.4697
  F1-Score: 0.6392
  Precision: 0.6017
  Recall: 0.6817
  Accuracy: 0.9818
New best model saved! Validation loss: 0.9313
  Corresponding target validation IoU: 0.4697
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-28 07:12:26.292196 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.5329, Src Seg Loss: 0.2685, Tgt Seg Loss: 0.7896, Contrastive Loss: 0.3060, Domain Loss: 0.6675
2025-06-28 07:15:17.278488 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.6744, Src Seg Loss: 0.3539, Tgt Seg Loss: 0.5916, Contrastive Loss: 0.2722, Domain Loss: 0.6146
2025-06-28 07:18:08.276172 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 2.8767, Src Seg Loss: 0.2876, Tgt Seg Loss: 0.7395, Contrastive Loss: 0.8297, Domain Loss: 0.6544
2025-06-28 07:20:59.284322 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.5787, Src Seg Loss: 0.3717, Tgt Seg Loss: 0.7007, Contrastive Loss: 0.1799, Domain Loss: 0.6630
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9230
  IoU: 0.4691
  F1-Score: 0.6386
  Precision: 0.6505
  Recall: 0.6271
  Accuracy: 0.9832
New best model saved! Validation loss: 0.9230
  Corresponding target validation IoU: 0.4691
Checkpoint saved at epoch 15: checkpoint_epoch_015.pth
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-28 07:23:58.646949 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.7100, Src Seg Loss: 0.3931, Tgt Seg Loss: 0.4022, Contrastive Loss: 0.4774, Domain Loss: 0.6727
2025-06-28 07:26:49.772511 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 2.5891, Src Seg Loss: 0.3844, Tgt Seg Loss: 0.6416, Contrastive Loss: 0.2676, Domain Loss: 0.7215
2025-06-28 07:29:42.323532 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 2.4119, Src Seg Loss: 0.3679, Tgt Seg Loss: 1.0021, Contrastive Loss: 0.0468, Domain Loss: 0.5630
2025-06-28 07:32:33.158412 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.5598, Src Seg Loss: 0.2976, Tgt Seg Loss: 0.6728, Contrastive Loss: 0.3001, Domain Loss: 0.7372
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9527
  IoU: 0.4708
  F1-Score: 0.6402
  Precision: 0.7028
  Recall: 0.5878
  Accuracy: 0.9844
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-28 07:35:31.683124 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.8420, Src Seg Loss: 0.3408, Tgt Seg Loss: 0.4758, Contrastive Loss: 0.4538, Domain Loss: 0.7466
2025-06-28 07:38:22.519099 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.8550, Src Seg Loss: 0.3099, Tgt Seg Loss: 0.6938, Contrastive Loss: 0.3341, Domain Loss: 0.6415
2025-06-28 07:41:13.266373 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.8187, Src Seg Loss: 0.3641, Tgt Seg Loss: 0.7723, Contrastive Loss: 0.5635, Domain Loss: 0.5663
2025-06-28 07:44:05.656292 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.8520, Src Seg Loss: 0.3639, Tgt Seg Loss: 0.8445, Contrastive Loss: 0.5538, Domain Loss: 0.5967
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9393
  IoU: 0.4859
  F1-Score: 0.6540
  Precision: 0.7131
  Recall: 0.6040
  Accuracy: 0.9849
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-28 07:47:04.416930 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.8619, Src Seg Loss: 0.3277, Tgt Seg Loss: 0.5873, Contrastive Loss: 0.5430, Domain Loss: 0.6764
2025-06-28 07:49:55.684802 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 2.9743, Src Seg Loss: 0.4279, Tgt Seg Loss: 0.6746, Contrastive Loss: 0.8415, Domain Loss: 0.6448
2025-06-28 07:52:46.839086 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.9363, Src Seg Loss: 0.4170, Tgt Seg Loss: 0.7597, Contrastive Loss: 0.6595, Domain Loss: 0.6115
2025-06-28 07:55:37.903067 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.9541, Src Seg Loss: 0.2318, Tgt Seg Loss: 0.3991, Contrastive Loss: 0.6647, Domain Loss: 0.7803
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9305
  IoU: 0.4889
  F1-Score: 0.6567
  Precision: 0.6761
  Recall: 0.6384
  Accuracy: 0.9842
--------------------Epoch: 19/100--------------------
Learning Rate: 5e-05
2025-06-28 07:58:38.184557 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 2.8524, Src Seg Loss: 0.3036, Tgt Seg Loss: 0.7839, Contrastive Loss: 0.7895, Domain Loss: 0.6632
2025-06-28 08:01:29.226663 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 2.9411, Src Seg Loss: 0.1933, Tgt Seg Loss: 0.6533, Contrastive Loss: 0.5930, Domain Loss: 0.6379
2025-06-28 08:04:21.089815 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 2.4391, Src Seg Loss: 0.3559, Tgt Seg Loss: 0.6285, Contrastive Loss: 0.0604, Domain Loss: 0.7234
2025-06-28 08:07:12.889215 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 2.4146, Src Seg Loss: 0.4358, Tgt Seg Loss: 0.3733, Contrastive Loss: 0.0948, Domain Loss: 0.7023
Epoch 19 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9335
  IoU: 0.4868
  F1-Score: 0.6548
  Precision: 0.6759
  Recall: 0.6349
  Accuracy: 0.9842
--------------------Epoch: 20/100--------------------
Learning Rate: 5e-05
2025-06-28 08:10:11.812295 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.4342, Src Seg Loss: 0.3407, Tgt Seg Loss: 0.8390, Contrastive Loss: 0.1109, Domain Loss: 0.7022
2025-06-28 08:13:02.651612 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 3.0027, Src Seg Loss: 0.1983, Tgt Seg Loss: 0.6683, Contrastive Loss: 0.7320, Domain Loss: 0.7378
2025-06-28 08:15:55.185193 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 3.1090, Src Seg Loss: 0.2392, Tgt Seg Loss: 0.6296, Contrastive Loss: 0.8103, Domain Loss: 0.6692
2025-06-28 08:18:45.981341 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 2.9997, Src Seg Loss: 0.3557, Tgt Seg Loss: 0.6423, Contrastive Loss: 0.7422, Domain Loss: 0.7056
Epoch 20 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9608
  IoU: 0.4859
  F1-Score: 0.6540
  Precision: 0.7275
  Recall: 0.5940
  Accuracy: 0.9851
Checkpoint saved at epoch 20: checkpoint_epoch_020.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 5e-05
2025-06-28 08:21:44.735147 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 2.9582, Src Seg Loss: 0.2791, Tgt Seg Loss: 0.7240, Contrastive Loss: 0.8598, Domain Loss: 0.6212
2025-06-28 08:24:35.603349 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 2.8395, Src Seg Loss: 0.4300, Tgt Seg Loss: 0.4003, Contrastive Loss: 0.5762, Domain Loss: 0.6542
2025-06-28 08:27:26.131394 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 2.8452, Src Seg Loss: 0.3042, Tgt Seg Loss: 0.8784, Contrastive Loss: 0.8023, Domain Loss: 0.7056
2025-06-28 08:30:19.742309 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 3.0107, Src Seg Loss: 0.3052, Tgt Seg Loss: 0.7225, Contrastive Loss: 0.8456, Domain Loss: 0.6694
Epoch 21 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9395
  IoU: 0.4979
  F1-Score: 0.6648
  Precision: 0.6938
  Recall: 0.6381
  Accuracy: 0.9848
--------------------Epoch: 22/100--------------------
Learning Rate: 5e-05
2025-06-28 08:33:19.054142 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 3.0028, Src Seg Loss: 0.2340, Tgt Seg Loss: 0.8668, Contrastive Loss: 0.8172, Domain Loss: 0.6221
2025-06-28 08:36:10.299874 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 3.0175, Src Seg Loss: 0.3580, Tgt Seg Loss: 0.6998, Contrastive Loss: 0.7101, Domain Loss: 0.6806
2025-06-28 08:39:01.623774 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 2.9291, Src Seg Loss: 0.4078, Tgt Seg Loss: 1.0006, Contrastive Loss: 0.5070, Domain Loss: 0.5572
2025-06-28 08:41:52.955993 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.9551, Src Seg Loss: 0.2950, Tgt Seg Loss: 0.6913, Contrastive Loss: 0.8418, Domain Loss: 0.6461
Epoch 22 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9507
  IoU: 0.4909
  F1-Score: 0.6585
  Precision: 0.7289
  Recall: 0.6006
  Accuracy: 0.9853
--------------------Epoch: 23/100--------------------
Learning Rate: 5e-05
2025-06-28 08:44:53.617373 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 2.9889, Src Seg Loss: 0.2477, Tgt Seg Loss: 0.6926, Contrastive Loss: 0.6668, Domain Loss: 0.5594
2025-06-28 08:47:45.046593 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 2.9758, Src Seg Loss: 0.2597, Tgt Seg Loss: 0.8015, Contrastive Loss: 0.8307, Domain Loss: 0.6823
2025-06-28 08:50:36.101880 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 3.0332, Src Seg Loss: 0.4266, Tgt Seg Loss: 0.8655, Contrastive Loss: 0.8458, Domain Loss: 0.6087
2025-06-28 08:53:26.796280 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 2.9778, Src Seg Loss: 0.2306, Tgt Seg Loss: 0.6504, Contrastive Loss: 0.9385, Domain Loss: 0.6430
Epoch 23 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9530
  IoU: 0.4900
  F1-Score: 0.6577
  Precision: 0.7164
  Recall: 0.6078
  Accuracy: 0.9850
--------------------Epoch: 24/100--------------------
Learning Rate: 5e-05
2025-06-28 08:56:25.625956 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 2.9577, Src Seg Loss: 0.2996, Tgt Seg Loss: 0.7229, Contrastive Loss: 0.9448, Domain Loss: 0.7518
2025-06-28 08:59:16.452707 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 2.9739, Src Seg Loss: 0.3789, Tgt Seg Loss: 0.6443, Contrastive Loss: 0.8626, Domain Loss: 0.7040
2025-06-28 09:02:08.695618 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 3.1132, Src Seg Loss: 0.3405, Tgt Seg Loss: 0.6805, Contrastive Loss: 0.9586, Domain Loss: 0.6681
2025-06-28 09:04:59.583083 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 3.1097, Src Seg Loss: 0.2462, Tgt Seg Loss: 0.8352, Contrastive Loss: 0.8598, Domain Loss: 0.7525
Epoch 24 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9702
  IoU: 0.4712
  F1-Score: 0.6406
  Precision: 0.7418
  Recall: 0.5637
  Accuracy: 0.9850
--------------------Epoch: 25/100--------------------
Learning Rate: 5e-05
2025-06-28 09:07:58.551463 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 3.0455, Src Seg Loss: 0.3225, Tgt Seg Loss: 0.8815, Contrastive Loss: 0.7853, Domain Loss: 0.6611
2025-06-28 09:10:49.799169 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 3.0366, Src Seg Loss: 0.3480, Tgt Seg Loss: 0.6581, Contrastive Loss: 0.9493, Domain Loss: 0.6426
2025-06-28 09:13:40.658889 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 3.0537, Src Seg Loss: 0.3193, Tgt Seg Loss: 0.8422, Contrastive Loss: 0.8519, Domain Loss: 0.6819
2025-06-28 09:16:32.898176 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 2.2735, Src Seg Loss: 0.2598, Tgt Seg Loss: 0.7346, Contrastive Loss: 0.1334, Domain Loss: 0.6327
Epoch 25 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9497
  IoU: 0.4881
  F1-Score: 0.6560
  Precision: 0.6690
  Recall: 0.6434
  Accuracy: 0.9840
Checkpoint saved at epoch 25: checkpoint_epoch_025.pth
--------------------Epoch: 26/100--------------------
Learning Rate: 5e-05
2025-06-28 09:19:31.986153 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 2.2364, Src Seg Loss: 0.2662, Tgt Seg Loss: 1.0023, Contrastive Loss: 0.0556, Domain Loss: 0.6755
2025-06-28 09:22:22.993182 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 2.4864, Src Seg Loss: 0.2470, Tgt Seg Loss: 0.7315, Contrastive Loss: 0.2883, Domain Loss: 0.7418
2025-06-28 09:25:14.173996 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 2.7255, Src Seg Loss: 0.3054, Tgt Seg Loss: 0.8464, Contrastive Loss: 0.3961, Domain Loss: 0.6754
2025-06-28 09:28:05.295694 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 2.2822, Src Seg Loss: 0.3367, Tgt Seg Loss: 0.4326, Contrastive Loss: 0.1616, Domain Loss: 0.7032
Epoch 26 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9783
  IoU: 0.4629
  F1-Score: 0.6328
  Precision: 0.7255
  Recall: 0.5611
  Accuracy: 0.9846
--------------------Epoch: 27/100--------------------
Learning Rate: 5e-05
2025-06-28 09:31:04.333887 Epoch [027/100], Step [0316/1264] (25%), Total Loss: 2.2874, Src Seg Loss: 0.2838, Tgt Seg Loss: 0.5873, Contrastive Loss: 0.0663, Domain Loss: 0.8881
2025-06-28 09:33:56.630020 Epoch [027/100], Step [0632/1264] (50%), Total Loss: 2.2874, Src Seg Loss: 0.3839, Tgt Seg Loss: 0.6432, Contrastive Loss: 0.0749, Domain Loss: 0.6693
2025-06-28 09:36:47.590823 Epoch [027/100], Step [0948/1264] (75%), Total Loss: 2.5730, Src Seg Loss: 0.2291, Tgt Seg Loss: 0.8319, Contrastive Loss: 0.6927, Domain Loss: 0.6397
2025-06-28 09:39:38.487385 Epoch [027/100], Step [1264/1264] (100%), Total Loss: 2.4804, Src Seg Loss: 0.2888, Tgt Seg Loss: 0.8048, Contrastive Loss: 0.1598, Domain Loss: 0.6610
Epoch 27 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9781
  IoU: 0.4982
  F1-Score: 0.6651
  Precision: 0.7386
  Recall: 0.6049
  Accuracy: 0.9856
Early stopping triggered at epoch 27
Best validation loss: 0.9230 achieved at epoch 15

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_camera_SMOKE5K-full_citizen_constraint (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 0.9230 achieved at epoch 15
Best model saved at: models/thesis/ablation-ld/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12691141
Cluster: snellius
User/Group: ytao/ytao
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 06:09:07
CPU Efficiency: 7.38% of 3-11:18:24 core-walltime
Job Wall-clock time: 05:12:24
Memory Utilized: 14.14 GB
Memory Efficiency: 17.68% of 80.00 GB (80.00 GB/node)
