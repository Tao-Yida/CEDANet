================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
üìã BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_expert_constraint_da

‚öôÔ∏è  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

üèóÔ∏è  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 32
  Latent Dimension: 8
  Contrastive Layer Filters: 8

üìä LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 1.0
  Domain Adaptation Loss: 1.0
  Pseudo Label Loss: 0.5

üîÑ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: True
  Use AttentionPool2d in Discriminators: True
  Pseudo Label Weight: 0.5

üéØ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

üìÅ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_camera/SMOKE5K-full/expert_constraint
  Pretrained Weights: None
  Model Save Path: models/thesis/E5/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_expert_constraint_da

‚úÖ VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  üìä Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

üîÄ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

üîÑ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
Ê∫êÂüüËÆ≠ÁªÉÈõÜ: 1264 batches (full dataset)
Total dataset size: 4302
Training set size: 3441
Validation set size: 861
ÁõÆÊ†áÂüüËÆ≠ÁªÉÈõÜ: 860 batches
ÁõÆÊ†áÂüüÈ™åËØÅÈõÜ: 215 batches
ÊûÑÂª∫Ê®°Âûã...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
Created save directory: models/thesis/E5/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_expert_constraint_da
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-28 04:28:14.790023 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 3.8702, Src Seg Loss: 1.2592, Tgt Seg Loss: 1.3483, Contrastive Loss: 0.5161, Domain Loss: 0.6959
2025-06-28 04:31:03.822601 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.5045, Src Seg Loss: 1.2035, Tgt Seg Loss: 1.0952, Contrastive Loss: 0.2221, Domain Loss: 0.5804
2025-06-28 04:33:55.733575 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 3.3042, Src Seg Loss: 0.9552, Tgt Seg Loss: 1.1460, Contrastive Loss: 0.2153, Domain Loss: 0.4514
2025-06-28 04:36:44.877401 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 3.2254, Src Seg Loss: 0.7371, Tgt Seg Loss: 1.1032, Contrastive Loss: 0.1750, Domain Loss: 0.5913
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 10.3084
  IoU: 0.2031
  F1-Score: 0.3377
  Precision: 0.4943
  Recall: 0.2564
  Accuracy: 0.9679
New best model saved! Validation loss: 10.3084
  Corresponding target validation IoU: 0.2031
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-28 04:39:43.204956 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 3.0059, Src Seg Loss: 0.9593, Tgt Seg Loss: 1.0135, Contrastive Loss: 0.3671, Domain Loss: 0.3299
2025-06-28 04:42:33.315899 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 3.0953, Src Seg Loss: 0.8435, Tgt Seg Loss: 0.8829, Contrastive Loss: 0.3682, Domain Loss: 0.4596
2025-06-28 04:45:23.429768 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 3.0059, Src Seg Loss: 0.6293, Tgt Seg Loss: 1.0087, Contrastive Loss: 0.6294, Domain Loss: 0.4356
2025-06-28 04:48:13.612369 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 2.9906, Src Seg Loss: 0.5092, Tgt Seg Loss: 0.9970, Contrastive Loss: 0.3991, Domain Loss: 0.4900
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0170
  IoU: 0.3516
  F1-Score: 0.5202
  Precision: 0.5006
  Recall: 0.5414
  Accuracy: 0.9681
New best model saved! Validation loss: 1.0170
  Corresponding target validation IoU: 0.3516
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-28 04:51:13.793667 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 2.7177, Src Seg Loss: 0.6626, Tgt Seg Loss: 0.8193, Contrastive Loss: 0.1177, Domain Loss: 0.4062
2025-06-28 04:54:04.178276 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 2.9239, Src Seg Loss: 0.7305, Tgt Seg Loss: 0.9664, Contrastive Loss: 0.2922, Domain Loss: 0.4660
2025-06-28 04:56:54.655351 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 2.8913, Src Seg Loss: 0.9555, Tgt Seg Loss: 0.9455, Contrastive Loss: 0.2492, Domain Loss: 0.4043
2025-06-28 04:59:45.114345 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 3.3536, Src Seg Loss: 0.8059, Tgt Seg Loss: 0.9412, Contrastive Loss: 0.8701, Domain Loss: 0.4573
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.8855
  IoU: 0.3094
  F1-Score: 0.4726
  Precision: 0.5363
  Recall: 0.4224
  Accuracy: 0.9699
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-28 05:02:43.682723 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 3.3278, Src Seg Loss: 0.5316, Tgt Seg Loss: 0.9404, Contrastive Loss: 0.6260, Domain Loss: 0.6161
2025-06-28 05:05:35.261811 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 3.1657, Src Seg Loss: 0.7205, Tgt Seg Loss: 0.6745, Contrastive Loss: 0.5908, Domain Loss: 0.5046
2025-06-28 05:08:25.568330 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 3.1128, Src Seg Loss: 0.4699, Tgt Seg Loss: 0.9178, Contrastive Loss: 0.7049, Domain Loss: 0.5936
2025-06-28 05:11:15.747750 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 2.8556, Src Seg Loss: 0.5576, Tgt Seg Loss: 0.7181, Contrastive Loss: 0.3343, Domain Loss: 0.6930
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0567
  IoU: 0.4106
  F1-Score: 0.5821
  Precision: 0.5459
  Recall: 0.6235
  Accuracy: 0.9714
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-28 05:14:14.251797 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 3.0076, Src Seg Loss: 0.7107, Tgt Seg Loss: 0.8026, Contrastive Loss: 0.4506, Domain Loss: 0.6023
2025-06-28 05:17:05.176119 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 2.8020, Src Seg Loss: 0.4885, Tgt Seg Loss: 0.7507, Contrastive Loss: 0.3026, Domain Loss: 0.5774
2025-06-28 05:19:55.378175 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 2.9925, Src Seg Loss: 0.4536, Tgt Seg Loss: 0.8035, Contrastive Loss: 0.6364, Domain Loss: 0.5908
2025-06-28 05:22:46.921664 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 2.9710, Src Seg Loss: 0.5782, Tgt Seg Loss: 0.7003, Contrastive Loss: 0.4422, Domain Loss: 0.5316
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.2450
  IoU: 0.3840
  F1-Score: 0.5549
  Precision: 0.6390
  Recall: 0.4904
  Accuracy: 0.9749
Checkpoint saved at epoch 5: checkpoint_epoch_005.pth
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-28 05:25:45.167238 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 2.9925, Src Seg Loss: 0.5497, Tgt Seg Loss: 1.0317, Contrastive Loss: 0.4464, Domain Loss: 0.5544
2025-06-28 05:28:35.225452 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 2.9601, Src Seg Loss: 0.4397, Tgt Seg Loss: 0.7820, Contrastive Loss: 0.9040, Domain Loss: 0.5950
2025-06-28 05:31:26.173911 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 3.1545, Src Seg Loss: 0.4958, Tgt Seg Loss: 0.6214, Contrastive Loss: 0.7204, Domain Loss: 0.6038
2025-06-28 05:34:16.631452 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 3.1464, Src Seg Loss: 0.5378, Tgt Seg Loss: 0.7854, Contrastive Loss: 0.6211, Domain Loss: 0.6147
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9440
  IoU: 0.4234
  F1-Score: 0.5949
  Precision: 0.6549
  Recall: 0.5449
  Accuracy: 0.9763
New best model saved! Validation loss: 0.9440
  Corresponding target validation IoU: 0.4234
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-28 05:37:16.443533 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 3.0186, Src Seg Loss: 0.5220, Tgt Seg Loss: 0.4727, Contrastive Loss: 0.7093, Domain Loss: 0.6132
2025-06-28 05:40:07.085410 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 3.0744, Src Seg Loss: 0.2993, Tgt Seg Loss: 0.7212, Contrastive Loss: 0.6270, Domain Loss: 0.6897
2025-06-28 05:42:57.977991 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 2.9619, Src Seg Loss: 0.3664, Tgt Seg Loss: 0.7494, Contrastive Loss: 0.4364, Domain Loss: 0.6033
2025-06-28 05:45:49.032888 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 3.0971, Src Seg Loss: 0.3769, Tgt Seg Loss: 0.8445, Contrastive Loss: 0.6931, Domain Loss: 0.5540
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.1863
  IoU: 0.3613
  F1-Score: 0.5308
  Precision: 0.7228
  Recall: 0.4195
  Accuracy: 0.9763
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-28 05:48:47.397491 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 3.0871, Src Seg Loss: 0.3239, Tgt Seg Loss: 0.8612, Contrastive Loss: 0.5604, Domain Loss: 0.6691
2025-06-28 05:51:39.050221 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 2.8056, Src Seg Loss: 0.4566, Tgt Seg Loss: 0.7051, Contrastive Loss: 0.6453, Domain Loss: 0.5576
2025-06-28 05:54:29.416661 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 2.9226, Src Seg Loss: 0.4738, Tgt Seg Loss: 0.8765, Contrastive Loss: 0.6072, Domain Loss: 0.6757
2025-06-28 05:57:20.144639 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 3.0077, Src Seg Loss: 0.4982, Tgt Seg Loss: 0.8387, Contrastive Loss: 0.6923, Domain Loss: 0.6459
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0161
  IoU: 0.4030
  F1-Score: 0.5745
  Precision: 0.7246
  Recall: 0.4758
  Accuracy: 0.9775
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-28 06:00:18.786849 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 2.9646, Src Seg Loss: 0.3624, Tgt Seg Loss: 0.4017, Contrastive Loss: 0.4625, Domain Loss: 0.8046
2025-06-28 06:03:09.758862 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 2.9980, Src Seg Loss: 0.3389, Tgt Seg Loss: 0.6411, Contrastive Loss: 0.5174, Domain Loss: 0.6218
2025-06-28 06:06:00.510776 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 2.7058, Src Seg Loss: 0.4196, Tgt Seg Loss: 0.7135, Contrastive Loss: 0.3852, Domain Loss: 0.7863
2025-06-28 06:08:52.883406 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 2.5666, Src Seg Loss: 0.4213, Tgt Seg Loss: 1.0123, Contrastive Loss: 0.1307, Domain Loss: 0.5637
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9292
  IoU: 0.4527
  F1-Score: 0.6232
  Precision: 0.6380
  Recall: 0.6091
  Accuracy: 0.9765
New best model saved! Validation loss: 0.9292
  Corresponding target validation IoU: 0.4527
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-28 06:11:51.942845 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 2.7995, Src Seg Loss: 0.4430, Tgt Seg Loss: 0.5820, Contrastive Loss: 0.3907, Domain Loss: 0.6184
2025-06-28 06:14:42.464964 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 2.8642, Src Seg Loss: 0.4286, Tgt Seg Loss: 0.6623, Contrastive Loss: 0.4580, Domain Loss: 0.6558
2025-06-28 06:17:32.662894 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 2.9438, Src Seg Loss: 0.5638, Tgt Seg Loss: 0.8696, Contrastive Loss: 0.3195, Domain Loss: 0.5667
2025-06-28 06:20:23.304061 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 2.9949, Src Seg Loss: 0.3916, Tgt Seg Loss: 0.9376, Contrastive Loss: 0.7476, Domain Loss: 0.6827
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9381
  IoU: 0.4425
  F1-Score: 0.6136
  Precision: 0.6488
  Recall: 0.5819
  Accuracy: 0.9766
Checkpoint saved at epoch 10: checkpoint_epoch_010.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-28 06:23:23.207835 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 3.0167, Src Seg Loss: 0.3844, Tgt Seg Loss: 0.8038, Contrastive Loss: 0.7018, Domain Loss: 0.7186
2025-06-28 06:26:13.745301 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.9546, Src Seg Loss: 0.3642, Tgt Seg Loss: 0.5169, Contrastive Loss: 0.5451, Domain Loss: 0.7681
2025-06-28 06:29:04.078799 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.8855, Src Seg Loss: 0.4936, Tgt Seg Loss: 0.5559, Contrastive Loss: 0.3856, Domain Loss: 0.5953
2025-06-28 06:31:54.425999 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.9366, Src Seg Loss: 0.3895, Tgt Seg Loss: 0.7953, Contrastive Loss: 0.5750, Domain Loss: 0.6236
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9501
  IoU: 0.4362
  F1-Score: 0.6074
  Precision: 0.6838
  Recall: 0.5465
  Accuracy: 0.9774
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-28 06:34:52.764346 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.9194, Src Seg Loss: 0.4075, Tgt Seg Loss: 0.6833, Contrastive Loss: 0.4263, Domain Loss: 0.5940
2025-06-28 06:37:44.350295 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.9367, Src Seg Loss: 0.4014, Tgt Seg Loss: 0.7747, Contrastive Loss: 0.6186, Domain Loss: 0.6729
2025-06-28 06:40:34.646152 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 2.8470, Src Seg Loss: 0.2331, Tgt Seg Loss: 0.7915, Contrastive Loss: 0.5673, Domain Loss: 0.7008
2025-06-28 06:43:25.239254 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 2.8924, Src Seg Loss: 0.3756, Tgt Seg Loss: 0.5808, Contrastive Loss: 0.5482, Domain Loss: 0.7076
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9479
  IoU: 0.4633
  F1-Score: 0.6333
  Precision: 0.6775
  Recall: 0.5944
  Accuracy: 0.9780
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-28 06:46:23.683133 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 2.8804, Src Seg Loss: 0.2613, Tgt Seg Loss: 0.4535, Contrastive Loss: 0.6780, Domain Loss: 0.7170
2025-06-28 06:49:14.359532 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 2.9844, Src Seg Loss: 0.4001, Tgt Seg Loss: 0.6761, Contrastive Loss: 0.5330, Domain Loss: 0.5119
2025-06-28 06:52:04.720674 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 2.4287, Src Seg Loss: 0.2984, Tgt Seg Loss: 0.5380, Contrastive Loss: 0.1279, Domain Loss: 0.6690
2025-06-28 06:54:56.773822 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.5031, Src Seg Loss: 0.4312, Tgt Seg Loss: 0.3775, Contrastive Loss: 0.1667, Domain Loss: 0.6201
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9705
  IoU: 0.4366
  F1-Score: 0.6078
  Precision: 0.6958
  Recall: 0.5396
  Accuracy: 0.9778
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-28 06:57:54.857924 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.4233, Src Seg Loss: 0.4472, Tgt Seg Loss: 0.7204, Contrastive Loss: 0.0738, Domain Loss: 0.6360
2025-06-28 07:00:45.500183 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.4795, Src Seg Loss: 0.4034, Tgt Seg Loss: 0.4908, Contrastive Loss: 0.1705, Domain Loss: 0.6124
2025-06-28 07:03:36.330570 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.5926, Src Seg Loss: 0.5252, Tgt Seg Loss: 0.6953, Contrastive Loss: 0.1279, Domain Loss: 0.6858
2025-06-28 07:06:27.613951 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.6254, Src Seg Loss: 0.4046, Tgt Seg Loss: 0.8805, Contrastive Loss: 0.1756, Domain Loss: 0.6168
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9494
  IoU: 0.4706
  F1-Score: 0.6400
  Precision: 0.6610
  Recall: 0.6203
  Accuracy: 0.9777
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-28 07:09:27.588944 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.3962, Src Seg Loss: 0.4880, Tgt Seg Loss: 0.8777, Contrastive Loss: 0.0655, Domain Loss: 0.6325
2025-06-28 07:12:17.554914 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.4757, Src Seg Loss: 0.4910, Tgt Seg Loss: 0.5754, Contrastive Loss: 0.2110, Domain Loss: 0.6019
2025-06-28 07:15:07.950210 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 2.5167, Src Seg Loss: 0.3766, Tgt Seg Loss: 1.0110, Contrastive Loss: 0.1743, Domain Loss: 0.6245
2025-06-28 07:17:58.210279 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.5537, Src Seg Loss: 0.5021, Tgt Seg Loss: 0.8529, Contrastive Loss: 0.2436, Domain Loss: 0.6354
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9392
  IoU: 0.4655
  F1-Score: 0.6353
  Precision: 0.6615
  Recall: 0.6111
  Accuracy: 0.9776
Checkpoint saved at epoch 15: checkpoint_epoch_015.pth
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-28 07:20:56.944539 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.5220, Src Seg Loss: 0.2876, Tgt Seg Loss: 0.8952, Contrastive Loss: 0.2499, Domain Loss: 0.6928
2025-06-28 07:23:48.374194 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 2.5613, Src Seg Loss: 0.2301, Tgt Seg Loss: 0.8582, Contrastive Loss: 0.2090, Domain Loss: 0.6978
2025-06-28 07:26:38.681775 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 2.5664, Src Seg Loss: 0.2742, Tgt Seg Loss: 0.5224, Contrastive Loss: 0.2916, Domain Loss: 0.6790
2025-06-28 07:29:29.154502 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.5480, Src Seg Loss: 0.3219, Tgt Seg Loss: 0.5228, Contrastive Loss: 0.2322, Domain Loss: 0.6699
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9303
  IoU: 0.4889
  F1-Score: 0.6568
  Precision: 0.6564
  Recall: 0.6571
  Accuracy: 0.9781
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-28 07:32:27.357373 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.4585, Src Seg Loss: 0.2811, Tgt Seg Loss: 0.2873, Contrastive Loss: 0.1993, Domain Loss: 0.9545
2025-06-28 07:35:18.706419 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.5266, Src Seg Loss: 0.3453, Tgt Seg Loss: 0.3465, Contrastive Loss: 0.1821, Domain Loss: 0.6596
2025-06-28 07:38:09.182634 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.8667, Src Seg Loss: 0.3646, Tgt Seg Loss: 0.4421, Contrastive Loss: 0.4538, Domain Loss: 0.6644
2025-06-28 07:41:00.968110 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.5087, Src Seg Loss: 0.2541, Tgt Seg Loss: 0.6791, Contrastive Loss: 0.1927, Domain Loss: 0.7115
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9378
  IoU: 0.4765
  F1-Score: 0.6455
  Precision: 0.6869
  Recall: 0.6087
  Accuracy: 0.9786
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-28 07:43:59.709803 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.4975, Src Seg Loss: 0.3742, Tgt Seg Loss: 0.3460, Contrastive Loss: 0.1820, Domain Loss: 0.6886
2025-06-28 07:46:50.927888 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 2.5517, Src Seg Loss: 0.3782, Tgt Seg Loss: 0.6707, Contrastive Loss: 0.1289, Domain Loss: 0.6555
2025-06-28 07:49:42.157008 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.5083, Src Seg Loss: 0.3500, Tgt Seg Loss: 0.5252, Contrastive Loss: 0.1958, Domain Loss: 0.6687
2025-06-28 07:52:33.049553 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.6339, Src Seg Loss: 0.3189, Tgt Seg Loss: 0.8990, Contrastive Loss: 0.5947, Domain Loss: 0.6793
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9514
  IoU: 0.4823
  F1-Score: 0.6507
  Precision: 0.6919
  Recall: 0.6142
  Accuracy: 0.9789
--------------------Epoch: 19/100--------------------
Learning Rate: 5e-05
2025-06-28 07:55:33.249947 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 2.6143, Src Seg Loss: 0.3229, Tgt Seg Loss: 0.4616, Contrastive Loss: 0.3652, Domain Loss: 0.6406
2025-06-28 07:58:24.053717 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 2.6115, Src Seg Loss: 0.4224, Tgt Seg Loss: 0.8619, Contrastive Loss: 0.3757, Domain Loss: 0.6429
2025-06-28 08:01:14.788655 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 2.4517, Src Seg Loss: 0.2089, Tgt Seg Loss: 0.5882, Contrastive Loss: 0.2063, Domain Loss: 0.8859
2025-06-28 08:04:05.424907 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 2.5605, Src Seg Loss: 0.3168, Tgt Seg Loss: 0.8412, Contrastive Loss: 0.3154, Domain Loss: 0.6329
Epoch 19 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9607
  IoU: 0.4735
  F1-Score: 0.6427
  Precision: 0.6998
  Recall: 0.5943
  Accuracy: 0.9789
--------------------Epoch: 20/100--------------------
Learning Rate: 5e-05
2025-06-28 08:07:03.744215 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.6023, Src Seg Loss: 0.2350, Tgt Seg Loss: 0.8533, Contrastive Loss: 0.2478, Domain Loss: 0.7338
2025-06-28 08:09:54.127413 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 2.5477, Src Seg Loss: 0.3027, Tgt Seg Loss: 0.4740, Contrastive Loss: 0.2451, Domain Loss: 0.7702
2025-06-28 08:12:45.697388 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 2.6085, Src Seg Loss: 0.3362, Tgt Seg Loss: 1.0018, Contrastive Loss: 0.2402, Domain Loss: 0.6250
2025-06-28 08:15:36.165980 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 2.6033, Src Seg Loss: 0.2270, Tgt Seg Loss: 0.6333, Contrastive Loss: 0.2461, Domain Loss: 0.6575
Epoch 20 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9257
  IoU: 0.4938
  F1-Score: 0.6611
  Precision: 0.6739
  Recall: 0.6488
  Accuracy: 0.9788
New best model saved! Validation loss: 0.9257
  Corresponding target validation IoU: 0.4938
Checkpoint saved at epoch 20: checkpoint_epoch_020.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 5e-05
2025-06-28 08:18:34.911733 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 2.5547, Src Seg Loss: 0.3197, Tgt Seg Loss: 0.4824, Contrastive Loss: 0.2328, Domain Loss: 0.6716
2025-06-28 08:21:25.522252 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 2.5960, Src Seg Loss: 0.2426, Tgt Seg Loss: 0.8393, Contrastive Loss: 0.1463, Domain Loss: 0.6837
2025-06-28 08:24:16.227155 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 2.6500, Src Seg Loss: 0.2778, Tgt Seg Loss: 0.8161, Contrastive Loss: 0.5368, Domain Loss: 0.7215
2025-06-28 08:27:08.364253 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 2.5326, Src Seg Loss: 0.2855, Tgt Seg Loss: 0.3585, Contrastive Loss: 0.4053, Domain Loss: 0.8039
Epoch 21 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9271
  IoU: 0.4892
  F1-Score: 0.6570
  Precision: 0.6774
  Recall: 0.6377
  Accuracy: 0.9787
--------------------Epoch: 22/100--------------------
Learning Rate: 5e-05
2025-06-28 08:30:06.692873 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 2.5798, Src Seg Loss: 0.2791, Tgt Seg Loss: 0.4561, Contrastive Loss: 0.4666, Domain Loss: 0.8436
2025-06-28 08:32:56.879656 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 2.6698, Src Seg Loss: 0.2744, Tgt Seg Loss: 0.8640, Contrastive Loss: 0.5247, Domain Loss: 0.6659
2025-06-28 08:35:47.169455 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 2.6243, Src Seg Loss: 0.2153, Tgt Seg Loss: 0.4159, Contrastive Loss: 0.4165, Domain Loss: 0.6934
2025-06-28 08:38:37.296613 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.6174, Src Seg Loss: 0.3008, Tgt Seg Loss: 0.6608, Contrastive Loss: 0.4717, Domain Loss: 0.7008
Epoch 22 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9726
  IoU: 0.4802
  F1-Score: 0.6488
  Precision: 0.7093
  Recall: 0.5979
  Accuracy: 0.9793
--------------------Epoch: 23/100--------------------
Learning Rate: 5e-05
2025-06-28 08:41:37.459519 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 2.6046, Src Seg Loss: 0.3245, Tgt Seg Loss: 0.8323, Contrastive Loss: 0.5185, Domain Loss: 0.6384
2025-06-28 08:44:27.938812 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 2.5152, Src Seg Loss: 0.2021, Tgt Seg Loss: 0.8081, Contrastive Loss: 0.4807, Domain Loss: 0.7173
2025-06-28 08:47:18.168918 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 2.6005, Src Seg Loss: 0.1927, Tgt Seg Loss: 0.3846, Contrastive Loss: 0.4712, Domain Loss: 0.6889
2025-06-28 08:50:08.416386 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 2.5129, Src Seg Loss: 0.2303, Tgt Seg Loss: 1.0014, Contrastive Loss: 0.2014, Domain Loss: 0.6388
Epoch 23 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9872
  IoU: 0.4684
  F1-Score: 0.6380
  Precision: 0.7112
  Recall: 0.5784
  Accuracy: 0.9790
--------------------Epoch: 24/100--------------------
Learning Rate: 5e-05
2025-06-28 08:53:06.473068 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 2.6916, Src Seg Loss: 0.3956, Tgt Seg Loss: 0.5097, Contrastive Loss: 0.5397, Domain Loss: 0.6724
2025-06-28 08:55:56.875209 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 2.5040, Src Seg Loss: 0.2868, Tgt Seg Loss: 0.4661, Contrastive Loss: 0.3210, Domain Loss: 0.6928
2025-06-28 08:58:48.529493 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 2.5370, Src Seg Loss: 0.2496, Tgt Seg Loss: 1.0022, Contrastive Loss: 0.2443, Domain Loss: 0.6567
2025-06-28 09:01:39.185498 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 2.4508, Src Seg Loss: 0.4468, Tgt Seg Loss: 0.6895, Contrastive Loss: 0.3715, Domain Loss: 0.6466
Epoch 24 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9325
  IoU: 0.4950
  F1-Score: 0.6622
  Precision: 0.6643
  Recall: 0.6601
  Accuracy: 0.9785
--------------------Epoch: 25/100--------------------
Learning Rate: 5e-05
2025-06-28 09:04:37.110886 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 2.3033, Src Seg Loss: 0.2242, Tgt Seg Loss: 0.5298, Contrastive Loss: 0.2322, Domain Loss: 0.6818
2025-06-28 09:07:27.149941 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 2.3581, Src Seg Loss: 0.2219, Tgt Seg Loss: 0.4499, Contrastive Loss: 0.0925, Domain Loss: 0.6957
2025-06-28 09:10:17.380756 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 2.3347, Src Seg Loss: 0.2454, Tgt Seg Loss: 0.4384, Contrastive Loss: 0.1480, Domain Loss: 0.6781
2025-06-28 09:13:08.779436 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 2.3563, Src Seg Loss: 0.2893, Tgt Seg Loss: 0.6296, Contrastive Loss: 0.1989, Domain Loss: 0.6233
Epoch 25 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9688
  IoU: 0.4921
  F1-Score: 0.6596
  Precision: 0.7082
  Recall: 0.6173
  Accuracy: 0.9797
Checkpoint saved at epoch 25: checkpoint_epoch_025.pth
--------------------Epoch: 26/100--------------------
Learning Rate: 5e-05
2025-06-28 09:16:07.241754 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 2.2685, Src Seg Loss: 0.2483, Tgt Seg Loss: 0.4844, Contrastive Loss: 0.1833, Domain Loss: 0.7296
2025-06-28 09:18:57.544813 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 2.3602, Src Seg Loss: 0.2288, Tgt Seg Loss: 0.4737, Contrastive Loss: 0.3138, Domain Loss: 0.6891
2025-06-28 09:21:47.618222 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 2.4592, Src Seg Loss: 0.3600, Tgt Seg Loss: 0.7899, Contrastive Loss: 0.1130, Domain Loss: 0.5945
2025-06-28 09:24:38.386956 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 2.4161, Src Seg Loss: 0.4003, Tgt Seg Loss: 0.8773, Contrastive Loss: 0.4322, Domain Loss: 0.6591
Epoch 26 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9626
  IoU: 0.4933
  F1-Score: 0.6606
  Precision: 0.7042
  Recall: 0.6222
  Accuracy: 0.9796
Early stopping triggered at epoch 26
Best validation loss: 0.9257 achieved at epoch 20

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_camera_SMOKE5K-full_expert_constraint (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 0.9257 achieved at epoch 20
Best model saved at: models/thesis/E5/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_expert_constraint_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_expert_constraint_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12691133
Cluster: snellius
User/Group: ytao/ytao
State: RUNNING
Nodes: 1
Cores per node: 16
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 3-07:58:40 core-walltime
Job Wall-clock time: 04:59:55
Memory Utilized: 0.00 MB
Memory Efficiency: 0.00% of 80.00 GB (80.00 GB/node)
WARNING: Efficiency statistics can only be obtained after the job has ended as seff tool is based on the accounting database data.
