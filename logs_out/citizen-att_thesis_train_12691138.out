================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
üìã BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚öôÔ∏è  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

üèóÔ∏è  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 32
  Latent Dimension: 8
  Contrastive Layer Filters: 8

üìä LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 1.0
  Domain Adaptation Loss: 1.0
  Pseudo Label Loss: 0.5

üîÑ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: False
  Use AttentionPool2d in Discriminators: True
  Pseudo Label Weight: 0.5

üéØ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

üìÅ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_camera/SMOKE5K-full/citizen_constraint
  Pretrained Weights: None
  Model Save Path: models/thesis/ablation-att/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚úÖ VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  üìä Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

üîÄ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

üîÑ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
Ê∫êÂüüËÆ≠ÁªÉÈõÜ: 1264 batches (full dataset)
Total dataset size: 4326
Training set size: 3460
Validation set size: 866
ÁõÆÊ†áÂüüËÆ≠ÁªÉÈõÜ: 865 batches
ÁõÆÊ†áÂüüÈ™åËØÅÈõÜ: 216 batches
ÊûÑÂª∫Ê®°Âûã...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-28 04:29:04.905827 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 3.8540, Src Seg Loss: 1.0998, Tgt Seg Loss: 1.2778, Contrastive Loss: 0.2480, Domain Loss: 0.6818
2025-06-28 04:30:42.367857 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.6899, Src Seg Loss: 1.2983, Tgt Seg Loss: 1.0579, Contrastive Loss: 0.1938, Domain Loss: 0.6560
2025-06-28 04:32:23.112529 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 3.3141, Src Seg Loss: 1.0229, Tgt Seg Loss: 1.1167, Contrastive Loss: 0.1335, Domain Loss: 0.5710
2025-06-28 04:34:01.443265 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 3.1688, Src Seg Loss: 1.2332, Tgt Seg Loss: 1.0082, Contrastive Loss: 0.0605, Domain Loss: 0.5023
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0978
  IoU: 0.2197
  F1-Score: 0.3603
  Precision: 0.3275
  Recall: 0.4004
  Accuracy: 0.9663
New best model saved! Validation loss: 1.0978
  Corresponding target validation IoU: 0.2197
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-28 04:35:49.854336 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 3.2239, Src Seg Loss: 0.8867, Tgt Seg Loss: 1.0595, Contrastive Loss: 0.1833, Domain Loss: 0.6931
2025-06-28 04:37:28.882116 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 3.2873, Src Seg Loss: 0.9581, Tgt Seg Loss: 1.0576, Contrastive Loss: 0.2693, Domain Loss: 0.6726
2025-06-28 04:39:07.903019 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 3.0103, Src Seg Loss: 0.8009, Tgt Seg Loss: 0.9893, Contrastive Loss: 0.2226, Domain Loss: 0.6698
2025-06-28 04:40:47.040615 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 3.1249, Src Seg Loss: 0.8555, Tgt Seg Loss: 0.9202, Contrastive Loss: 0.3210, Domain Loss: 0.7340
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9921
  IoU: 0.3213
  F1-Score: 0.4863
  Precision: 0.4731
  Recall: 0.5003
  Accuracy: 0.9750
New best model saved! Validation loss: 0.9921
  Corresponding target validation IoU: 0.3213
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-28 04:42:37.682763 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 2.9997, Src Seg Loss: 0.5868, Tgt Seg Loss: 1.1276, Contrastive Loss: 0.0405, Domain Loss: 0.7260
2025-06-28 04:44:17.425763 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 3.1158, Src Seg Loss: 0.5235, Tgt Seg Loss: 0.9403, Contrastive Loss: 0.4051, Domain Loss: 0.6753
2025-06-28 04:45:57.473538 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 3.0171, Src Seg Loss: 0.5661, Tgt Seg Loss: 0.8678, Contrastive Loss: 0.3230, Domain Loss: 0.6789
2025-06-28 04:47:38.723342 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 3.0210, Src Seg Loss: 0.6509, Tgt Seg Loss: 0.9108, Contrastive Loss: 0.2465, Domain Loss: 0.7118
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9850
  IoU: 0.3386
  F1-Score: 0.5059
  Precision: 0.5368
  Recall: 0.4783
  Accuracy: 0.9779
New best model saved! Validation loss: 0.9850
  Corresponding target validation IoU: 0.3386
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-28 04:49:26.338247 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 3.1856, Src Seg Loss: 0.5818, Tgt Seg Loss: 0.9578, Contrastive Loss: 0.3593, Domain Loss: 0.7059
2025-06-28 04:51:05.625479 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 3.1400, Src Seg Loss: 0.7323, Tgt Seg Loss: 0.8146, Contrastive Loss: 0.2643, Domain Loss: 0.7132
2025-06-28 04:52:44.748269 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 3.0743, Src Seg Loss: 0.6156, Tgt Seg Loss: 0.9141, Contrastive Loss: 0.3718, Domain Loss: 0.6733
2025-06-28 04:54:23.860745 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 3.1217, Src Seg Loss: 0.4721, Tgt Seg Loss: 1.0198, Contrastive Loss: 0.2079, Domain Loss: 0.6902
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 1.0060
  IoU: 0.3246
  F1-Score: 0.4902
  Precision: 0.4975
  Recall: 0.4830
  Accuracy: 0.9762
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-28 04:56:10.850496 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 3.1770, Src Seg Loss: 0.4269, Tgt Seg Loss: 1.0258, Contrastive Loss: 0.4086, Domain Loss: 0.6816
2025-06-28 04:57:50.133423 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 3.1153, Src Seg Loss: 0.5032, Tgt Seg Loss: 0.8410, Contrastive Loss: 0.5974, Domain Loss: 0.6826
2025-06-28 04:59:29.494455 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 3.1101, Src Seg Loss: 0.5811, Tgt Seg Loss: 1.0441, Contrastive Loss: 0.2551, Domain Loss: 0.6876
2025-06-28 05:01:08.710785 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 3.1524, Src Seg Loss: 0.5572, Tgt Seg Loss: 0.9397, Contrastive Loss: 0.4849, Domain Loss: 0.6850
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9452
  IoU: 0.3751
  F1-Score: 0.5456
  Precision: 0.4368
  Recall: 0.7264
  Accuracy: 0.9714
New best model saved! Validation loss: 0.9452
  Corresponding target validation IoU: 0.3751
Checkpoint saved at epoch 5: checkpoint_epoch_005.pth
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-28 05:02:58.745561 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 3.1103, Src Seg Loss: 0.4812, Tgt Seg Loss: 0.7393, Contrastive Loss: 0.6253, Domain Loss: 0.6764
2025-06-28 05:04:38.415731 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 3.1081, Src Seg Loss: 0.5954, Tgt Seg Loss: 0.8863, Contrastive Loss: 0.5358, Domain Loss: 0.6900
2025-06-28 05:06:18.025813 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 3.0977, Src Seg Loss: 0.4119, Tgt Seg Loss: 0.9702, Contrastive Loss: 0.6394, Domain Loss: 0.6824
2025-06-28 05:07:57.324045 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 3.3966, Src Seg Loss: 0.5382, Tgt Seg Loss: 0.9559, Contrastive Loss: 0.8612, Domain Loss: 0.6899
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9403
  IoU: 0.4096
  F1-Score: 0.5812
  Precision: 0.5439
  Recall: 0.6239
  Accuracy: 0.9787
New best model saved! Validation loss: 0.9403
  Corresponding target validation IoU: 0.4096
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-28 05:09:44.446220 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 3.3358, Src Seg Loss: 0.4915, Tgt Seg Loss: 0.8357, Contrastive Loss: 0.9202, Domain Loss: 0.6951
2025-06-28 05:11:23.436036 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 3.2550, Src Seg Loss: 0.5242, Tgt Seg Loss: 0.9599, Contrastive Loss: 0.7437, Domain Loss: 0.6776
2025-06-28 05:13:02.448370 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 3.3270, Src Seg Loss: 0.4234, Tgt Seg Loss: 0.9123, Contrastive Loss: 0.9352, Domain Loss: 0.6782
2025-06-28 05:14:41.304713 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 3.3508, Src Seg Loss: 0.4209, Tgt Seg Loss: 0.9428, Contrastive Loss: 0.9198, Domain Loss: 0.6726
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9432
  IoU: 0.4245
  F1-Score: 0.5960
  Precision: 0.6219
  Recall: 0.5722
  Accuracy: 0.9816
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-28 05:16:28.242812 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 3.3618, Src Seg Loss: 0.3624, Tgt Seg Loss: 0.7993, Contrastive Loss: 0.8428, Domain Loss: 0.6967
2025-06-28 05:18:07.319819 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 3.2918, Src Seg Loss: 0.4593, Tgt Seg Loss: 0.6324, Contrastive Loss: 0.9098, Domain Loss: 0.6835
2025-06-28 05:19:47.796858 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 3.3236, Src Seg Loss: 0.5789, Tgt Seg Loss: 0.8868, Contrastive Loss: 0.7559, Domain Loss: 0.6777
2025-06-28 05:21:26.956297 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 3.2759, Src Seg Loss: 0.3948, Tgt Seg Loss: 0.8286, Contrastive Loss: 0.9790, Domain Loss: 0.6859
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9222
  IoU: 0.4281
  F1-Score: 0.5995
  Precision: 0.5161
  Recall: 0.7151
  Accuracy: 0.9774
New best model saved! Validation loss: 0.9222
  Corresponding target validation IoU: 0.4281
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-28 05:23:14.503312 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 3.2067, Src Seg Loss: 0.3177, Tgt Seg Loss: 0.6965, Contrastive Loss: 0.8299, Domain Loss: 0.6992
2025-06-28 05:24:53.694081 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 3.1720, Src Seg Loss: 0.6821, Tgt Seg Loss: 0.9265, Contrastive Loss: 0.6725, Domain Loss: 0.6696
2025-06-28 05:26:32.743151 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 3.2157, Src Seg Loss: 0.4644, Tgt Seg Loss: 1.0113, Contrastive Loss: 0.3448, Domain Loss: 0.6840
2025-06-28 05:28:11.714662 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 3.2693, Src Seg Loss: 0.4538, Tgt Seg Loss: 0.7437, Contrastive Loss: 0.9524, Domain Loss: 0.6792
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9390
  IoU: 0.4503
  F1-Score: 0.6210
  Precision: 0.6283
  Recall: 0.6138
  Accuracy: 0.9823
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-28 05:29:59.076060 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 3.2791, Src Seg Loss: 0.4965, Tgt Seg Loss: 1.0050, Contrastive Loss: 0.8495, Domain Loss: 0.6912
2025-06-28 05:31:38.433264 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 3.3040, Src Seg Loss: 0.5282, Tgt Seg Loss: 0.8948, Contrastive Loss: 0.8034, Domain Loss: 0.6605
2025-06-28 05:33:17.674138 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 3.2630, Src Seg Loss: 0.3648, Tgt Seg Loss: 0.6854, Contrastive Loss: 0.7815, Domain Loss: 0.6963
2025-06-28 05:34:58.250337 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 3.2462, Src Seg Loss: 0.3447, Tgt Seg Loss: 0.7549, Contrastive Loss: 0.8547, Domain Loss: 0.7014
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9437
  IoU: 0.4493
  F1-Score: 0.6200
  Precision: 0.6445
  Recall: 0.5973
  Accuracy: 0.9827
Checkpoint saved at epoch 10: checkpoint_epoch_010.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-28 05:36:45.839671 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 2.5138, Src Seg Loss: 0.3399, Tgt Seg Loss: 0.8610, Contrastive Loss: 0.0721, Domain Loss: 0.6948
2025-06-28 05:38:24.821861 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.4532, Src Seg Loss: 0.2876, Tgt Seg Loss: 0.8136, Contrastive Loss: 0.0201, Domain Loss: 0.6921
2025-06-28 05:40:03.855972 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.8195, Src Seg Loss: 0.3796, Tgt Seg Loss: 0.8037, Contrastive Loss: 0.4325, Domain Loss: 0.6835
2025-06-28 05:41:42.831490 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.9428, Src Seg Loss: 0.4244, Tgt Seg Loss: 0.7699, Contrastive Loss: 0.5947, Domain Loss: 0.6874
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9256
  IoU: 0.4541
  F1-Score: 0.6246
  Precision: 0.5826
  Recall: 0.6731
  Accuracy: 0.9808
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-28 05:43:29.840297 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.8673, Src Seg Loss: 0.3505, Tgt Seg Loss: 0.8736, Contrastive Loss: 0.5067, Domain Loss: 0.7057
2025-06-28 05:45:09.020505 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.9405, Src Seg Loss: 0.3338, Tgt Seg Loss: 0.6961, Contrastive Loss: 0.4978, Domain Loss: 0.7191
2025-06-28 05:46:47.932638 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 3.0195, Src Seg Loss: 0.4487, Tgt Seg Loss: 1.0549, Contrastive Loss: 0.6651, Domain Loss: 0.6942
2025-06-28 05:48:26.844699 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 3.1977, Src Seg Loss: 0.4348, Tgt Seg Loss: 0.8430, Contrastive Loss: 0.8446, Domain Loss: 0.6726
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9284
  IoU: 0.4761
  F1-Score: 0.6451
  Precision: 0.6564
  Recall: 0.6342
  Accuracy: 0.9835
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-28 05:50:15.164057 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 3.1727, Src Seg Loss: 0.4836, Tgt Seg Loss: 0.6328, Contrastive Loss: 0.7068, Domain Loss: 0.6982
2025-06-28 05:51:53.823569 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 3.2026, Src Seg Loss: 0.3715, Tgt Seg Loss: 0.7670, Contrastive Loss: 0.9992, Domain Loss: 0.6748
2025-06-28 05:53:32.701050 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 3.0877, Src Seg Loss: 0.3695, Tgt Seg Loss: 0.7417, Contrastive Loss: 0.6509, Domain Loss: 0.7029
2025-06-28 05:55:11.712520 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.7582, Src Seg Loss: 0.3241, Tgt Seg Loss: 0.7174, Contrastive Loss: 0.4504, Domain Loss: 0.7121
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9194
  IoU: 0.4641
  F1-Score: 0.6340
  Precision: 0.6299
  Recall: 0.6382
  Accuracy: 0.9826
New best model saved! Validation loss: 0.9194
  Corresponding target validation IoU: 0.4641
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-28 05:56:59.191828 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.7284, Src Seg Loss: 0.3640, Tgt Seg Loss: 0.8893, Contrastive Loss: 0.2811, Domain Loss: 0.6932
2025-06-28 05:58:38.158839 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.7300, Src Seg Loss: 0.4419, Tgt Seg Loss: 0.8769, Contrastive Loss: 0.5184, Domain Loss: 0.6720
2025-06-28 06:00:17.213124 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.8100, Src Seg Loss: 0.3615, Tgt Seg Loss: 0.6119, Contrastive Loss: 0.5115, Domain Loss: 0.7313
2025-06-28 06:01:55.974269 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.8685, Src Seg Loss: 0.4553, Tgt Seg Loss: 0.7128, Contrastive Loss: 0.5057, Domain Loss: 0.7166
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9356
  IoU: 0.4676
  F1-Score: 0.6372
  Precision: 0.6620
  Recall: 0.6142
  Accuracy: 0.9834
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-28 06:03:46.944362 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.8772, Src Seg Loss: 0.3105, Tgt Seg Loss: 0.7819, Contrastive Loss: 0.5472, Domain Loss: 0.6881
2025-06-28 06:05:28.143451 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.8517, Src Seg Loss: 0.3738, Tgt Seg Loss: 0.5911, Contrastive Loss: 0.5888, Domain Loss: 0.6978
2025-06-28 06:07:07.876243 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 2.8855, Src Seg Loss: 0.3149, Tgt Seg Loss: 0.7645, Contrastive Loss: 0.6973, Domain Loss: 0.7041
2025-06-28 06:08:47.615407 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.8678, Src Seg Loss: 0.3329, Tgt Seg Loss: 0.6814, Contrastive Loss: 0.5445, Domain Loss: 0.6958
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9444
  IoU: 0.4530
  F1-Score: 0.6235
  Precision: 0.6980
  Recall: 0.5634
  Accuracy: 0.9839
Checkpoint saved at epoch 15: checkpoint_epoch_015.pth
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-28 06:10:34.922584 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.7717, Src Seg Loss: 0.3346, Tgt Seg Loss: 0.4779, Contrastive Loss: 0.4528, Domain Loss: 0.7009
2025-06-28 06:12:14.502633 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 2.8854, Src Seg Loss: 0.3305, Tgt Seg Loss: 0.6660, Contrastive Loss: 0.6089, Domain Loss: 0.6865
2025-06-28 06:13:53.610073 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 2.9010, Src Seg Loss: 0.4569, Tgt Seg Loss: 1.0108, Contrastive Loss: 0.4609, Domain Loss: 0.6688
2025-06-28 06:15:32.426025 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.9589, Src Seg Loss: 0.3895, Tgt Seg Loss: 0.6507, Contrastive Loss: 0.7888, Domain Loss: 0.7137
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9631
  IoU: 0.4690
  F1-Score: 0.6386
  Precision: 0.7151
  Recall: 0.5768
  Accuracy: 0.9845
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-28 06:17:19.274476 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.9396, Src Seg Loss: 0.3600, Tgt Seg Loss: 0.4944, Contrastive Loss: 0.6282, Domain Loss: 0.6700
2025-06-28 06:18:58.308995 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.7709, Src Seg Loss: 0.3408, Tgt Seg Loss: 0.6794, Contrastive Loss: 0.4162, Domain Loss: 0.6559
2025-06-28 06:20:38.780382 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.8406, Src Seg Loss: 0.3407, Tgt Seg Loss: 0.7570, Contrastive Loss: 0.6114, Domain Loss: 0.6537
2025-06-28 06:22:17.722741 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.4991, Src Seg Loss: 0.3343, Tgt Seg Loss: 0.8743, Contrastive Loss: 0.2034, Domain Loss: 0.6853
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9559
  IoU: 0.4724
  F1-Score: 0.6416
  Precision: 0.7092
  Recall: 0.5858
  Accuracy: 0.9845
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-28 06:24:04.426281 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.5995, Src Seg Loss: 0.3533, Tgt Seg Loss: 0.6123, Contrastive Loss: 0.4159, Domain Loss: 0.7080
2025-06-28 06:25:43.275324 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 2.3165, Src Seg Loss: 0.2735, Tgt Seg Loss: 0.6937, Contrastive Loss: 0.0891, Domain Loss: 0.7170
2025-06-28 06:27:22.259686 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.4870, Src Seg Loss: 0.2902, Tgt Seg Loss: 0.7317, Contrastive Loss: 0.3944, Domain Loss: 0.7032
2025-06-28 06:29:01.127182 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.8401, Src Seg Loss: 0.3720, Tgt Seg Loss: 0.3826, Contrastive Loss: 0.3644, Domain Loss: 0.7359
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9607
  IoU: 0.4577
  F1-Score: 0.6280
  Precision: 0.7172
  Recall: 0.5585
  Accuracy: 0.9843
--------------------Epoch: 19/100--------------------
Learning Rate: 5e-05
2025-06-28 06:30:48.355759 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 2.8424, Src Seg Loss: 0.2539, Tgt Seg Loss: 0.7513, Contrastive Loss: 0.6238, Domain Loss: 0.6819
2025-06-28 06:32:27.574122 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 2.8080, Src Seg Loss: 0.3486, Tgt Seg Loss: 0.6697, Contrastive Loss: 0.5989, Domain Loss: 0.6517
2025-06-28 06:34:06.819020 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 2.8042, Src Seg Loss: 0.3009, Tgt Seg Loss: 0.6138, Contrastive Loss: 0.3444, Domain Loss: 0.6768
2025-06-28 06:35:47.381358 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 2.4289, Src Seg Loss: 0.3716, Tgt Seg Loss: 0.4059, Contrastive Loss: 0.2722, Domain Loss: 0.7033
Epoch 19 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9459
  IoU: 0.4710
  F1-Score: 0.6404
  Precision: 0.6819
  Recall: 0.6037
  Accuracy: 0.9840
--------------------Epoch: 20/100--------------------
Learning Rate: 5e-05
2025-06-28 06:37:34.803954 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.4830, Src Seg Loss: 0.3507, Tgt Seg Loss: 0.8318, Contrastive Loss: 0.1372, Domain Loss: 0.6534
2025-06-28 06:39:14.191404 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 2.5966, Src Seg Loss: 0.2964, Tgt Seg Loss: 0.5949, Contrastive Loss: 0.5006, Domain Loss: 0.6839
2025-06-28 06:40:53.470140 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 2.5754, Src Seg Loss: 0.2702, Tgt Seg Loss: 0.6203, Contrastive Loss: 0.3178, Domain Loss: 0.7016
2025-06-28 06:42:32.673492 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 2.6033, Src Seg Loss: 0.3353, Tgt Seg Loss: 0.6260, Contrastive Loss: 0.4902, Domain Loss: 0.6806
Epoch 20 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9720
  IoU: 0.4827
  F1-Score: 0.6511
  Precision: 0.7376
  Recall: 0.5828
  Accuracy: 0.9852
Checkpoint saved at epoch 20: checkpoint_epoch_020.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 5e-05
2025-06-28 06:44:19.801151 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 2.6591, Src Seg Loss: 0.2450, Tgt Seg Loss: 0.6772, Contrastive Loss: 0.5271, Domain Loss: 0.6832
2025-06-28 06:45:58.785307 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 2.6281, Src Seg Loss: 0.2993, Tgt Seg Loss: 0.4060, Contrastive Loss: 0.5240, Domain Loss: 0.7056
2025-06-28 06:47:37.630708 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 2.5985, Src Seg Loss: 0.5429, Tgt Seg Loss: 0.8914, Contrastive Loss: 0.5237, Domain Loss: 0.6608
2025-06-28 06:49:16.712260 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 2.6996, Src Seg Loss: 0.3683, Tgt Seg Loss: 0.7440, Contrastive Loss: 0.7770, Domain Loss: 0.6740
Epoch 21 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9320
  IoU: 0.4833
  F1-Score: 0.6516
  Precision: 0.6545
  Recall: 0.6487
  Accuracy: 0.9836
--------------------Epoch: 22/100--------------------
Learning Rate: 5e-05
2025-06-28 06:51:03.762707 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 3.0065, Src Seg Loss: 0.3022, Tgt Seg Loss: 0.8620, Contrastive Loss: 0.8054, Domain Loss: 0.6950
2025-06-28 06:52:44.549165 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 2.9099, Src Seg Loss: 0.3156, Tgt Seg Loss: 0.6988, Contrastive Loss: 0.7788, Domain Loss: 0.6687
2025-06-28 06:54:23.599097 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 2.8753, Src Seg Loss: 0.2794, Tgt Seg Loss: 1.0076, Contrastive Loss: 0.4103, Domain Loss: 0.6112
2025-06-28 06:56:02.524138 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.8871, Src Seg Loss: 0.3507, Tgt Seg Loss: 0.7135, Contrastive Loss: 0.7497, Domain Loss: 0.6422
Epoch 22 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9243
  IoU: 0.4959
  F1-Score: 0.6630
  Precision: 0.6530
  Recall: 0.6734
  Accuracy: 0.9838
--------------------Epoch: 23/100--------------------
Learning Rate: 5e-05
2025-06-28 06:57:49.424784 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 2.8751, Src Seg Loss: 0.3053, Tgt Seg Loss: 0.6930, Contrastive Loss: 0.8422, Domain Loss: 0.6966
2025-06-28 06:59:28.533967 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 2.9029, Src Seg Loss: 0.2377, Tgt Seg Loss: 0.7968, Contrastive Loss: 0.6516, Domain Loss: 0.6715
2025-06-28 07:01:07.525832 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 2.8906, Src Seg Loss: 0.3258, Tgt Seg Loss: 0.8710, Contrastive Loss: 0.6859, Domain Loss: 0.6318
2025-06-28 07:02:46.579782 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 2.8138, Src Seg Loss: 0.2316, Tgt Seg Loss: 0.6371, Contrastive Loss: 0.6003, Domain Loss: 0.6317
Epoch 23 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9635
  IoU: 0.5017
  F1-Score: 0.6682
  Precision: 0.7302
  Recall: 0.6159
  Accuracy: 0.9855
--------------------Epoch: 24/100--------------------
Learning Rate: 5e-05
2025-06-28 07:04:34.307063 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 2.8684, Src Seg Loss: 0.3207, Tgt Seg Loss: 0.6534, Contrastive Loss: 0.8498, Domain Loss: 0.6344
2025-06-28 07:06:15.193280 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 2.8394, Src Seg Loss: 0.2934, Tgt Seg Loss: 0.3964, Contrastive Loss: 0.9021, Domain Loss: 0.6308
2025-06-28 07:07:54.200418 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 2.7103, Src Seg Loss: 0.2904, Tgt Seg Loss: 0.4319, Contrastive Loss: 0.7143, Domain Loss: 0.6328
2025-06-28 07:09:33.283937 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 2.6938, Src Seg Loss: 0.2379, Tgt Seg Loss: 0.6190, Contrastive Loss: 0.4869, Domain Loss: 0.6366
Epoch 24 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8693
  IoU: 0.4671
  F1-Score: 0.6368
  Precision: 0.6213
  Recall: 0.6530
  Accuracy: 0.9824
New best model saved! Validation loss: 0.8693
  Corresponding target validation IoU: 0.4671
--------------------Epoch: 25/100--------------------
Learning Rate: 5e-05
2025-06-28 07:11:20.484742 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 2.6385, Src Seg Loss: 0.2575, Tgt Seg Loss: 0.5412, Contrastive Loss: 0.5275, Domain Loss: 0.5870
2025-06-28 07:12:59.473309 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 2.6281, Src Seg Loss: 0.2731, Tgt Seg Loss: 0.4697, Contrastive Loss: 0.5947, Domain Loss: 0.6255
2025-06-28 07:14:38.380263 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 2.6455, Src Seg Loss: 0.2325, Tgt Seg Loss: 0.5955, Contrastive Loss: 0.6956, Domain Loss: 0.6260
2025-06-28 07:16:17.173090 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 2.6516, Src Seg Loss: 0.1915, Tgt Seg Loss: 0.4936, Contrastive Loss: 0.7794, Domain Loss: 0.6280
Epoch 25 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8380
  IoU: 0.4697
  F1-Score: 0.6392
  Precision: 0.6547
  Recall: 0.6243
  Accuracy: 0.9833
New best model saved! Validation loss: 0.8380
  Corresponding target validation IoU: 0.4697
Checkpoint saved at epoch 25: checkpoint_epoch_025.pth
--------------------Epoch: 26/100--------------------
Learning Rate: 5e-05
2025-06-28 07:18:04.355315 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 2.6206, Src Seg Loss: 0.1927, Tgt Seg Loss: 0.5027, Contrastive Loss: 0.2693, Domain Loss: 0.5537
2025-06-28 07:19:43.151359 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 2.6627, Src Seg Loss: 0.1809, Tgt Seg Loss: 0.5419, Contrastive Loss: 0.5323, Domain Loss: 0.6146
2025-06-28 07:21:23.944446 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 2.6340, Src Seg Loss: 0.2932, Tgt Seg Loss: 0.4972, Contrastive Loss: 0.6931, Domain Loss: 0.5848
2025-06-28 07:23:02.624184 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 2.6369, Src Seg Loss: 0.2849, Tgt Seg Loss: 0.3095, Contrastive Loss: 0.7403, Domain Loss: 0.6801
Epoch 26 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7859
  IoU: 0.5108
  F1-Score: 0.6762
  Precision: 0.6650
  Recall: 0.6877
  Accuracy: 0.9844
New best model saved! Validation loss: 0.7859
  Corresponding target validation IoU: 0.5108
Early stopping triggered at epoch 26
Best validation loss: 0.7859 achieved at epoch 26

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_camera_SMOKE5K-full_citizen_constraint (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 0.7859 achieved at epoch 26
Best model saved at: models/thesis/ablation-att/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12691138
Cluster: snellius
User/Group: ytao/ytao
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 03:51:38
CPU Efficiency: 8.21% of 1-23:01:04 core-walltime
Job Wall-clock time: 02:56:19
Memory Utilized: 13.46 GB
Memory Efficiency: 16.83% of 80.00 GB (80.00 GB/node)
