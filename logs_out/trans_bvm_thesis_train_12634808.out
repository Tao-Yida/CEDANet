================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
üìã BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚öôÔ∏è  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

üèóÔ∏è  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 64
  Latent Dimension: 8
  Contrastive Layer Filters: 16

üìä LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 2.0
  Domain Adaptation Loss: 2.0
  Pseudo Label Loss: 0.5

üîÑ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: False
  Use AttentionPool2d in Discriminators: False
  Pseudo Label Weight: 0.5

üéØ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

üìÅ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_camera/SMOKE5K-full/citizen_constraint
  Pretrained Weights: None
  Model Save Path: models/thesis/smoke5k-to-ijmond-citizen-constraint-full/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da

‚úÖ VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  üìä Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

üîÄ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

üîÑ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
Ê∫êÂüüËÆ≠ÁªÉÈõÜ: 1264 batches (full dataset)
Total dataset size: 4215
Training set size: 3372
Validation set size: 843
ÁõÆÊ†áÂüüËÆ≠ÁªÉÈõÜ: 843 batches
ÁõÆÊ†áÂüüÈ™åËØÅÈõÜ: 210 batches
ÊûÑÂª∫Ê®°Âûã...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-26 07:20:42.499899 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 4.3513, Src Seg Loss: 0.9299, Tgt Seg Loss: 1.0705, Contrastive Loss: 0.0035, Domain Loss: 1.2453
2025-06-26 07:24:15.789300 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.7163, Src Seg Loss: 0.8428, Tgt Seg Loss: 0.7731, Contrastive Loss: 0.0408, Domain Loss: 1.0030
2025-06-26 07:27:48.666132 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 2.9883, Src Seg Loss: 0.7463, Tgt Seg Loss: 1.0511, Contrastive Loss: 0.0000, Domain Loss: 1.2203
2025-06-26 07:31:20.591174 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 2.6530, Src Seg Loss: 0.6653, Tgt Seg Loss: 0.8639, Contrastive Loss: 0.0003, Domain Loss: 0.7176
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8947
  IoU: 0.4220
  F1-Score: 0.5936
  Precision: 0.6231
  Recall: 0.5667
  Accuracy: 0.9646
New best model saved! Training loss: 3.8489
  Corresponding target validation IoU: 0.4220 (reference)
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-26 07:35:08.855907 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 3.4037, Src Seg Loss: 0.6243, Tgt Seg Loss: 0.8795, Contrastive Loss: 0.0000, Domain Loss: 1.3029
2025-06-26 07:38:40.764552 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 3.3196, Src Seg Loss: 0.6535, Tgt Seg Loss: 0.6368, Contrastive Loss: 0.0133, Domain Loss: 1.1829
2025-06-26 07:42:12.981265 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 3.1387, Src Seg Loss: 0.3785, Tgt Seg Loss: 0.8536, Contrastive Loss: 0.0000, Domain Loss: 1.3281
2025-06-26 07:45:45.066523 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 3.0426, Src Seg Loss: 0.4577, Tgt Seg Loss: 0.8400, Contrastive Loss: 0.0003, Domain Loss: 1.2758
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8594
  IoU: 0.4259
  F1-Score: 0.5974
  Precision: 0.7248
  Recall: 0.5080
  Accuracy: 0.9687
New best model saved! Training loss: 3.3538
  Corresponding target validation IoU: 0.4259 (reference)
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-26 07:49:33.241512 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 3.1824, Src Seg Loss: 0.5863, Tgt Seg Loss: 0.7266, Contrastive Loss: 0.0002, Domain Loss: 1.1438
2025-06-26 07:53:05.166402 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 3.2136, Src Seg Loss: 0.7273, Tgt Seg Loss: 0.7202, Contrastive Loss: 0.0000, Domain Loss: 1.1148
2025-06-26 07:56:37.143300 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 3.2502, Src Seg Loss: 0.5243, Tgt Seg Loss: 0.6625, Contrastive Loss: 0.0000, Domain Loss: 1.4611
2025-06-26 08:00:08.987264 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 3.3527, Src Seg Loss: 0.4956, Tgt Seg Loss: 0.6308, Contrastive Loss: 0.0000, Domain Loss: 1.2520
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.9217
  IoU: 0.4483
  F1-Score: 0.6191
  Precision: 0.7274
  Recall: 0.5389
  Accuracy: 0.9697
New best model saved! Training loss: 3.1776
  Corresponding target validation IoU: 0.4483 (reference)
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-26 08:03:57.306069 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 3.0969, Src Seg Loss: 0.4702, Tgt Seg Loss: 0.5799, Contrastive Loss: 0.0000, Domain Loss: 1.3723
2025-06-26 08:07:29.337717 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 3.0264, Src Seg Loss: 0.4909, Tgt Seg Loss: 0.5583, Contrastive Loss: 0.0000, Domain Loss: 1.2995
2025-06-26 08:11:01.132116 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 2.9351, Src Seg Loss: 0.4464, Tgt Seg Loss: 0.7105, Contrastive Loss: 0.0000, Domain Loss: 1.2215
2025-06-26 08:14:33.111503 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 2.9661, Src Seg Loss: 0.5429, Tgt Seg Loss: 0.7484, Contrastive Loss: 0.0000, Domain Loss: 1.2852
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7832
  IoU: 0.5093
  F1-Score: 0.6749
  Precision: 0.7601
  Recall: 0.6069
  Accuracy: 0.9733
New best model saved! Training loss: 3.0416
  Corresponding target validation IoU: 0.5093 (reference)
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-26 08:18:21.378716 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 2.9360, Src Seg Loss: 0.4355, Tgt Seg Loss: 0.5789, Contrastive Loss: 0.0000, Domain Loss: 1.2321
2025-06-26 08:21:53.346104 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 2.9531, Src Seg Loss: 0.4834, Tgt Seg Loss: 0.6768, Contrastive Loss: 0.0000, Domain Loss: 1.1706
2025-06-26 08:25:25.277536 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 2.9495, Src Seg Loss: 0.5942, Tgt Seg Loss: 0.5075, Contrastive Loss: 0.0000, Domain Loss: 1.1286
2025-06-26 08:28:57.259649 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 2.8976, Src Seg Loss: 0.5035, Tgt Seg Loss: 0.5063, Contrastive Loss: 0.0000, Domain Loss: 1.4990
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7420
  IoU: 0.5265
  F1-Score: 0.6898
  Precision: 0.6455
  Recall: 0.7406
  Accuracy: 0.9696
New best model saved! Training loss: 2.9386
  Corresponding target validation IoU: 0.5265 (reference)
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-26 08:32:45.641089 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 2.9344, Src Seg Loss: 0.4647, Tgt Seg Loss: 0.5028, Contrastive Loss: 0.0015, Domain Loss: 1.2484
2025-06-26 08:36:17.524343 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 3.0629, Src Seg Loss: 0.3208, Tgt Seg Loss: 0.4338, Contrastive Loss: 0.0000, Domain Loss: 1.5271
2025-06-26 08:39:49.601858 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 3.0288, Src Seg Loss: 0.2553, Tgt Seg Loss: 0.4810, Contrastive Loss: 0.0000, Domain Loss: 1.4777
2025-06-26 08:43:21.781398 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 3.0907, Src Seg Loss: 0.4439, Tgt Seg Loss: 0.5869, Contrastive Loss: 0.0000, Domain Loss: 1.3672
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7861
  IoU: 0.5093
  F1-Score: 0.6748
  Precision: 0.7258
  Recall: 0.6306
  Accuracy: 0.9723
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-26 08:47:09.631104 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 3.0600, Src Seg Loss: 0.2801, Tgt Seg Loss: 0.6283, Contrastive Loss: 0.0003, Domain Loss: 1.3824
2025-06-26 08:50:41.715948 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 3.0605, Src Seg Loss: 0.3371, Tgt Seg Loss: 0.5206, Contrastive Loss: 0.0000, Domain Loss: 1.3401
2025-06-26 08:54:13.748656 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 2.9126, Src Seg Loss: 0.3713, Tgt Seg Loss: 0.5817, Contrastive Loss: 0.0000, Domain Loss: 1.3907
2025-06-26 08:57:45.811836 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 2.9234, Src Seg Loss: 0.3364, Tgt Seg Loss: 0.5713, Contrastive Loss: 0.0014, Domain Loss: 1.3369
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7520
  IoU: 0.5207
  F1-Score: 0.6848
  Precision: 0.6968
  Recall: 0.6733
  Accuracy: 0.9717
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-26 09:01:33.867330 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 2.8956, Src Seg Loss: 0.3556, Tgt Seg Loss: 0.5279, Contrastive Loss: 0.0000, Domain Loss: 1.3251
2025-06-26 09:05:05.826642 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 2.8596, Src Seg Loss: 0.2583, Tgt Seg Loss: 0.4200, Contrastive Loss: 0.0000, Domain Loss: 1.4678
2025-06-26 09:08:38.040284 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 2.8925, Src Seg Loss: 0.5274, Tgt Seg Loss: 0.5305, Contrastive Loss: 0.0000, Domain Loss: 1.3255
2025-06-26 09:12:10.118434 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 2.8104, Src Seg Loss: 0.3850, Tgt Seg Loss: 0.3595, Contrastive Loss: 0.0143, Domain Loss: 1.1150
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7741
  IoU: 0.5308
  F1-Score: 0.6935
  Precision: 0.7260
  Recall: 0.6638
  Accuracy: 0.9732
New best model saved! Training loss: 2.8797
  Corresponding target validation IoU: 0.5308 (reference)
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-26 09:15:58.393935 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 2.8470, Src Seg Loss: 0.4470, Tgt Seg Loss: 0.5291, Contrastive Loss: 0.0017, Domain Loss: 1.3318
2025-06-26 09:19:30.328947 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 2.8477, Src Seg Loss: 0.3167, Tgt Seg Loss: 0.4651, Contrastive Loss: 0.0000, Domain Loss: 1.4723
2025-06-26 09:23:02.189483 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 2.8281, Src Seg Loss: 0.3746, Tgt Seg Loss: 0.4288, Contrastive Loss: 0.0000, Domain Loss: 1.3558
2025-06-26 09:26:34.178369 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 2.8123, Src Seg Loss: 0.2290, Tgt Seg Loss: 0.5829, Contrastive Loss: 0.0000, Domain Loss: 1.4344
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7456
  IoU: 0.5376
  F1-Score: 0.6993
  Precision: 0.7493
  Recall: 0.6555
  Accuracy: 0.9743
New best model saved! Training loss: 2.8426
  Corresponding target validation IoU: 0.5376 (reference)
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-26 09:30:22.766226 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 2.8388, Src Seg Loss: 0.2426, Tgt Seg Loss: 0.4723, Contrastive Loss: 0.0000, Domain Loss: 1.3792
2025-06-26 09:33:54.663901 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 2.8091, Src Seg Loss: 0.2284, Tgt Seg Loss: 0.4174, Contrastive Loss: 0.0000, Domain Loss: 1.4238
2025-06-26 09:37:26.833376 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 2.8365, Src Seg Loss: 0.2891, Tgt Seg Loss: 0.3258, Contrastive Loss: 0.0000, Domain Loss: 1.4363
2025-06-26 09:40:58.896559 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 2.7945, Src Seg Loss: 0.3941, Tgt Seg Loss: 0.3490, Contrastive Loss: 0.0000, Domain Loss: 1.3190
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7229
  IoU: 0.5492
  F1-Score: 0.7090
  Precision: 0.6840
  Recall: 0.7359
  Accuracy: 0.9724
New best model saved! Training loss: 2.7976
  Corresponding target validation IoU: 0.5492 (reference)
Checkpoint saved: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da_epoch_010_from_scratch.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-26 09:44:47.149717 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 2.7794, Src Seg Loss: 0.3051, Tgt Seg Loss: 0.4296, Contrastive Loss: 0.0003, Domain Loss: 1.4340
2025-06-26 09:48:19.198663 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.7347, Src Seg Loss: 0.3547, Tgt Seg Loss: 0.3408, Contrastive Loss: 0.0000, Domain Loss: 1.3240
2025-06-26 09:51:51.316343 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.7697, Src Seg Loss: 0.2774, Tgt Seg Loss: 0.3887, Contrastive Loss: 0.0000, Domain Loss: 1.3923
2025-06-26 09:55:23.578625 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.7703, Src Seg Loss: 0.2575, Tgt Seg Loss: 0.3456, Contrastive Loss: 0.0007, Domain Loss: 1.3726
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7317
  IoU: 0.5432
  F1-Score: 0.7040
  Precision: 0.6889
  Recall: 0.7199
  Accuracy: 0.9724
New best model saved! Training loss: 2.7648
  Corresponding target validation IoU: 0.5432 (reference)
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-26 09:59:12.042092 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.7734, Src Seg Loss: 0.3681, Tgt Seg Loss: 0.3888, Contrastive Loss: 0.0000, Domain Loss: 1.2818
2025-06-26 10:02:44.053782 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.7248, Src Seg Loss: 0.3050, Tgt Seg Loss: 0.3900, Contrastive Loss: 0.0007, Domain Loss: 1.1974
2025-06-26 10:06:16.171146 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 2.7041, Src Seg Loss: 0.3058, Tgt Seg Loss: 0.4676, Contrastive Loss: 0.0000, Domain Loss: 1.2068
2025-06-26 10:09:48.415189 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 2.6989, Src Seg Loss: 0.2761, Tgt Seg Loss: 0.4133, Contrastive Loss: 0.0000, Domain Loss: 1.3415
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7499
  IoU: 0.5514
  F1-Score: 0.7108
  Precision: 0.6991
  Recall: 0.7229
  Accuracy: 0.9732
New best model saved! Training loss: 2.7300
  Corresponding target validation IoU: 0.5514 (reference)
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-26 10:13:36.580546 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 2.6811, Src Seg Loss: 0.3869, Tgt Seg Loss: 0.3502, Contrastive Loss: 0.0459, Domain Loss: 1.1240
2025-06-26 10:17:08.607099 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 2.6990, Src Seg Loss: 0.2783, Tgt Seg Loss: 0.2989, Contrastive Loss: 0.0000, Domain Loss: 1.2323
2025-06-26 10:20:40.964082 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 2.6840, Src Seg Loss: 0.3164, Tgt Seg Loss: 0.2666, Contrastive Loss: 0.0000, Domain Loss: 1.3023
2025-06-26 10:24:13.212443 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.6382, Src Seg Loss: 0.2594, Tgt Seg Loss: 0.3636, Contrastive Loss: 0.0007, Domain Loss: 1.2249
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7542
  IoU: 0.5496
  F1-Score: 0.7093
  Precision: 0.7217
  Recall: 0.6974
  Accuracy: 0.9739
New best model saved! Training loss: 2.6856
  Corresponding target validation IoU: 0.5496 (reference)
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-26 10:28:01.393562 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.6294, Src Seg Loss: 0.2806, Tgt Seg Loss: 0.3537, Contrastive Loss: 0.0000, Domain Loss: 1.2148
2025-06-26 10:31:33.455809 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.6555, Src Seg Loss: 0.2882, Tgt Seg Loss: 0.2840, Contrastive Loss: 0.0000, Domain Loss: 1.4347
2025-06-26 10:35:05.523152 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.6538, Src Seg Loss: 0.2154, Tgt Seg Loss: 0.2226, Contrastive Loss: 0.0003, Domain Loss: 1.3939
2025-06-26 10:38:37.684203 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.6733, Src Seg Loss: 0.2341, Tgt Seg Loss: 0.2876, Contrastive Loss: 0.0009, Domain Loss: 1.3661
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8404
  IoU: 0.5343
  F1-Score: 0.6964
  Precision: 0.7366
  Recall: 0.6605
  Accuracy: 0.9737
New best model saved! Training loss: 2.6468
  Corresponding target validation IoU: 0.5343 (reference)
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-26 10:42:29.744845 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.6310, Src Seg Loss: 0.2547, Tgt Seg Loss: 0.3508, Contrastive Loss: 0.0000, Domain Loss: 1.4154
2025-06-26 10:46:01.728415 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.5931, Src Seg Loss: 0.2442, Tgt Seg Loss: 0.3114, Contrastive Loss: 0.0000, Domain Loss: 1.3608
2025-06-26 10:49:33.927755 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 2.6132, Src Seg Loss: 0.2082, Tgt Seg Loss: 0.2574, Contrastive Loss: 0.0000, Domain Loss: 1.3335
2025-06-26 10:53:06.045576 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.5770, Src Seg Loss: 0.2693, Tgt Seg Loss: 0.2714, Contrastive Loss: 0.0000, Domain Loss: 1.0445
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7971
  IoU: 0.5446
  F1-Score: 0.7051
  Precision: 0.7497
  Recall: 0.6656
  Accuracy: 0.9746
New best model saved! Training loss: 2.6216
  Corresponding target validation IoU: 0.5446 (reference)
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-26 10:56:55.530234 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.5512, Src Seg Loss: 0.2415, Tgt Seg Loss: 0.3756, Contrastive Loss: 0.0000, Domain Loss: 1.2127
2025-06-26 11:00:27.469361 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 2.6518, Src Seg Loss: 0.2513, Tgt Seg Loss: 0.3356, Contrastive Loss: 0.0000, Domain Loss: 1.3317
2025-06-26 11:03:59.616191 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 2.5647, Src Seg Loss: 0.2427, Tgt Seg Loss: 0.2765, Contrastive Loss: 0.0000, Domain Loss: 1.1869
2025-06-26 11:07:31.732609 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.6127, Src Seg Loss: 0.2493, Tgt Seg Loss: 0.3751, Contrastive Loss: 0.0000, Domain Loss: 1.3942
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7893
  IoU: 0.5372
  F1-Score: 0.6989
  Precision: 0.7434
  Recall: 0.6595
  Accuracy: 0.9741
New best model saved! Training loss: 2.5983
  Corresponding target validation IoU: 0.5372 (reference)
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-26 11:11:19.750551 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.5994, Src Seg Loss: 0.1992, Tgt Seg Loss: 0.3116, Contrastive Loss: 0.0000, Domain Loss: 1.3381
2025-06-26 11:14:51.795649 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.5537, Src Seg Loss: 0.3056, Tgt Seg Loss: 0.3747, Contrastive Loss: 0.0000, Domain Loss: 1.1019
2025-06-26 11:18:23.901281 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.5447, Src Seg Loss: 0.2410, Tgt Seg Loss: 0.4347, Contrastive Loss: 0.0000, Domain Loss: 1.1677
2025-06-26 11:21:56.242733 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.5167, Src Seg Loss: 0.2201, Tgt Seg Loss: 0.2586, Contrastive Loss: 0.0000, Domain Loss: 1.1412
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8097
  IoU: 0.5438
  F1-Score: 0.7045
  Precision: 0.7324
  Recall: 0.6786
  Accuracy: 0.9740
New best model saved! Training loss: 2.5609
  Corresponding target validation IoU: 0.5438 (reference)
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-26 11:25:44.369093 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.7345, Src Seg Loss: 0.2652, Tgt Seg Loss: 0.3904, Contrastive Loss: 0.0000, Domain Loss: 1.2562
2025-06-26 11:29:16.465745 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 2.6347, Src Seg Loss: 0.3754, Tgt Seg Loss: 0.3143, Contrastive Loss: 0.0000, Domain Loss: 1.3201
2025-06-26 11:32:48.706332 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.5862, Src Seg Loss: 0.2621, Tgt Seg Loss: 0.2506, Contrastive Loss: 0.0003, Domain Loss: 1.4854
2025-06-26 11:36:20.991769 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.6102, Src Seg Loss: 0.1075, Tgt Seg Loss: 0.2183, Contrastive Loss: 0.1735, Domain Loss: 1.3186
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7991
  IoU: 0.5308
  F1-Score: 0.6935
  Precision: 0.7339
  Recall: 0.6573
  Accuracy: 0.9735
--------------------Epoch: 19/100--------------------
Learning Rate: 5e-05
2025-06-26 11:40:08.747795 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 2.5879, Src Seg Loss: 0.2854, Tgt Seg Loss: 0.2460, Contrastive Loss: 0.0000, Domain Loss: 1.3043
2025-06-26 11:43:40.991107 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 2.4781, Src Seg Loss: 0.2956, Tgt Seg Loss: 0.2849, Contrastive Loss: 0.0000, Domain Loss: 1.1180
2025-06-26 11:47:13.246057 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 2.4976, Src Seg Loss: 0.2247, Tgt Seg Loss: 0.3605, Contrastive Loss: 0.0000, Domain Loss: 1.1109
2025-06-26 11:50:45.366249 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 2.6403, Src Seg Loss: 0.2252, Tgt Seg Loss: 0.3553, Contrastive Loss: 0.0000, Domain Loss: 1.5649
Epoch 19 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8313
  IoU: 0.5097
  F1-Score: 0.6753
  Precision: 0.7418
  Recall: 0.6197
  Accuracy: 0.9728
New best model saved! Training loss: 2.5501
  Corresponding target validation IoU: 0.5097 (reference)
--------------------Epoch: 20/100--------------------
Learning Rate: 5e-05
2025-06-26 11:54:35.758133 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.7622, Src Seg Loss: 0.2685, Tgt Seg Loss: 0.2415, Contrastive Loss: 0.0000, Domain Loss: 1.4183
2025-06-26 11:58:07.731534 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 2.5871, Src Seg Loss: 0.2286, Tgt Seg Loss: 0.2295, Contrastive Loss: 0.0000, Domain Loss: 1.3181
2025-06-26 12:01:39.753959 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 2.5365, Src Seg Loss: 0.1232, Tgt Seg Loss: 0.3137, Contrastive Loss: 0.0000, Domain Loss: 1.5673
2025-06-26 12:05:11.871521 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 2.5142, Src Seg Loss: 0.1909, Tgt Seg Loss: 0.2526, Contrastive Loss: 0.0000, Domain Loss: 1.1507
Epoch 20 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8227
  IoU: 0.5306
  F1-Score: 0.6933
  Precision: 0.7637
  Recall: 0.6348
  Accuracy: 0.9744
Checkpoint saved: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da_epoch_020_from_scratch.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 5e-05
2025-06-26 12:08:59.975814 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 2.5404, Src Seg Loss: 0.2618, Tgt Seg Loss: 0.2483, Contrastive Loss: 0.0000, Domain Loss: 1.1549
2025-06-26 12:12:32.046500 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 2.4940, Src Seg Loss: 0.2675, Tgt Seg Loss: 0.3202, Contrastive Loss: 0.0000, Domain Loss: 1.1321
2025-06-26 12:16:04.154034 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 2.4148, Src Seg Loss: 0.2460, Tgt Seg Loss: 0.3007, Contrastive Loss: 0.0000, Domain Loss: 0.9990
2025-06-26 12:19:36.475116 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 2.4192, Src Seg Loss: 0.2509, Tgt Seg Loss: 0.3333, Contrastive Loss: 0.0000, Domain Loss: 1.4081
Epoch 21 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8513
  IoU: 0.5129
  F1-Score: 0.6780
  Precision: 0.7706
  Recall: 0.6053
  Accuracy: 0.9738
New best model saved! Training loss: 2.4578
  Corresponding target validation IoU: 0.5129 (reference)
--------------------Epoch: 22/100--------------------
Learning Rate: 5e-05
2025-06-26 12:23:26.395622 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 2.4129, Src Seg Loss: 0.2735, Tgt Seg Loss: 0.2814, Contrastive Loss: 0.0000, Domain Loss: 1.3899
2025-06-26 12:26:58.509590 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 2.7179, Src Seg Loss: 0.3306, Tgt Seg Loss: 0.3076, Contrastive Loss: 0.0000, Domain Loss: 1.4655
2025-06-26 12:30:30.844100 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 2.6367, Src Seg Loss: 0.2795, Tgt Seg Loss: 0.2001, Contrastive Loss: 0.0000, Domain Loss: 1.4472
2025-06-26 12:34:03.060479 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.6145, Src Seg Loss: 0.2206, Tgt Seg Loss: 0.2863, Contrastive Loss: 0.0000, Domain Loss: 1.3873
Epoch 22 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7942
  IoU: 0.5329
  F1-Score: 0.6953
  Precision: 0.7288
  Recall: 0.6647
  Accuracy: 0.9734
--------------------Epoch: 23/100--------------------
Learning Rate: 5e-05
2025-06-26 12:37:50.859574 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 2.5095, Src Seg Loss: 0.2479, Tgt Seg Loss: 0.1946, Contrastive Loss: 0.0000, Domain Loss: 1.2294
2025-06-26 12:41:22.862423 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 2.6163, Src Seg Loss: 0.2025, Tgt Seg Loss: 0.2186, Contrastive Loss: 0.0000, Domain Loss: 1.3714
2025-06-26 12:44:54.934939 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 2.6260, Src Seg Loss: 0.1397, Tgt Seg Loss: 0.2785, Contrastive Loss: 0.0003, Domain Loss: 1.5643
2025-06-26 12:48:26.987457 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 2.5548, Src Seg Loss: 0.2207, Tgt Seg Loss: 0.2734, Contrastive Loss: 0.0000, Domain Loss: 1.4938
Epoch 23 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8279
  IoU: 0.5373
  F1-Score: 0.6990
  Precision: 0.7231
  Recall: 0.6765
  Accuracy: 0.9734
--------------------Epoch: 24/100--------------------
Learning Rate: 5e-05
2025-06-26 12:52:14.596912 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 2.4887, Src Seg Loss: 0.2034, Tgt Seg Loss: 0.4344, Contrastive Loss: 0.0000, Domain Loss: 1.4771
2025-06-26 12:55:46.625449 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 2.5555, Src Seg Loss: 0.1989, Tgt Seg Loss: 0.2124, Contrastive Loss: 0.0000, Domain Loss: 1.3637
2025-06-26 12:59:18.721386 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 2.5448, Src Seg Loss: 0.2189, Tgt Seg Loss: 0.3326, Contrastive Loss: 0.0000, Domain Loss: 1.2912
2025-06-26 13:02:50.841384 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 2.5091, Src Seg Loss: 0.1614, Tgt Seg Loss: 0.3689, Contrastive Loss: 0.0000, Domain Loss: 1.2488
Epoch 24 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8318
  IoU: 0.5325
  F1-Score: 0.6950
  Precision: 0.7170
  Recall: 0.6742
  Accuracy: 0.9730
--------------------Epoch: 25/100--------------------
Learning Rate: 5e-05
2025-06-26 13:06:38.570642 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 2.4665, Src Seg Loss: 0.3292, Tgt Seg Loss: 0.2469, Contrastive Loss: 0.0021, Domain Loss: 0.9540
2025-06-26 13:10:10.626939 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 2.8404, Src Seg Loss: 0.2332, Tgt Seg Loss: 0.2318, Contrastive Loss: 0.0000, Domain Loss: 1.5945
2025-06-26 13:13:42.788266 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 2.8083, Src Seg Loss: 0.2280, Tgt Seg Loss: 0.3736, Contrastive Loss: 0.0003, Domain Loss: 1.4284
2025-06-26 13:17:14.848788 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 2.6876, Src Seg Loss: 0.1838, Tgt Seg Loss: 0.2791, Contrastive Loss: 0.0000, Domain Loss: 1.5955
Epoch 25 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8028
  IoU: 0.5253
  F1-Score: 0.6888
  Precision: 0.7187
  Recall: 0.6612
  Accuracy: 0.9727
--------------------Epoch: 26/100--------------------
Learning Rate: 5e-05
2025-06-26 13:21:02.879068 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 2.7395, Src Seg Loss: 0.2070, Tgt Seg Loss: 0.3067, Contrastive Loss: 0.0000, Domain Loss: 1.7741
2025-06-26 13:24:34.883003 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 2.4177, Src Seg Loss: 0.2008, Tgt Seg Loss: 0.3309, Contrastive Loss: 0.0000, Domain Loss: 1.0636
2025-06-26 13:28:07.003999 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 2.4202, Src Seg Loss: 0.1798, Tgt Seg Loss: 0.2138, Contrastive Loss: 0.0000, Domain Loss: 1.2257
2025-06-26 13:31:39.171967 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 2.4059, Src Seg Loss: 0.2295, Tgt Seg Loss: 0.2284, Contrastive Loss: 0.0000, Domain Loss: 1.1402
Epoch 26 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8890
  IoU: 0.5263
  F1-Score: 0.6897
  Precision: 0.7578
  Recall: 0.6328
  Accuracy: 0.9740
Early stopping triggered at epoch 26
Best training loss: 2.4578 achieved at epoch 21

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_camera_SMOKE5K-full_citizen_constraint (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 2.4578 achieved at epoch 21
Best model saved at: models/thesis/smoke5k-to-ijmond-citizen-constraint-full/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_camera_SMOKE5K-full_citizen_constraint_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12634808
Cluster: snellius
User/Group: ytao/ytao
State: RUNNING
Nodes: 1
Cores per node: 9
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 2-08:16:57 core-walltime
Job Wall-clock time: 06:15:13
Memory Utilized: 0.00 MB
Memory Efficiency: 0.00% of 24.00 GB (24.00 GB/node)
WARNING: Efficiency statistics can only be obtained after the job has ended as seff tool is based on the accounting database data.
