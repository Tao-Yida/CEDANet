================================================================================
DOMAIN ADAPTIVE TRAINING CONFIGURATION
================================================================================
ðŸ“‹ BASIC TRAINING SETTINGS
----------------------------------------
  Training Epochs: 100
  Batch Size: 4
  Training Image Size: 352x352
  Device: cuda
  Model Name: SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_data_train_da

âš™ï¸  OPTIMIZER SETTINGS
----------------------------------------
  Learning Rate: 5e-05
  Adam Beta: 0.5
  Gradient Clipping: 0.5
  LR Decay Factor: 0.8
  LR Patience (epochs): 12

ðŸ—ï¸  MODEL ARCHITECTURE
----------------------------------------
  Feature Channels: 32
  Latent Dimension: 8
  Contrastive Layer Filters: 8

ðŸ“Š LOSS FUNCTION WEIGHTS
----------------------------------------
  L2 Regularization: 0.0001
  Latent Loss: 2.0
  VAE Loss: 0.6
  Contrastive Loss: 1.0
  Domain Adaptation Loss: 1.0
  Pseudo Label Loss: 0.5

ðŸ”„ DOMAIN ADAPTATION SETTINGS
----------------------------------------
  Number of Domains: 2
  Gradient Reversal Lambda Max: 1.0
  Use LDConv in Discriminators: True
  Use AttentionPool2d in Discriminators: True
  Pseudo Label Weight: 0.5

ðŸŽ¯ SEMI-SUPERVISED LEARNING
----------------------------------------
  Contrastive Pixel Matching: Intra-image
  Contrastive Sample Count: 500

ðŸ“ DATASET CONFIGURATION
----------------------------------------
  Source Domain Path: data/SMOKE5K_Dataset/SMOKE5K/train
  Target Domain Path: data/ijmond_data/train
  Pretrained Weights: None
  Model Save Path: models/thesis/gold/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_data_train_da

âœ… VALIDATION & EARLY STOPPING
----------------------------------------
  Enable Validation: True
  Validation Domain: Target Domain
  Validation Split: 0.2 (of target data)
  Early Stopping Patience: 25
  Min Delta for Improvement: 0.0001
  ðŸ“Š Validation Strategy: Target domain split for training/validation
     - Source domain: Full dataset for training
     - Target domain: Split into training/validation sets

ðŸ”€ DATA AUGMENTATION & REPRODUCIBILITY
----------------------------------------
  Data Augmentation (Both Domains): True
  Freeze Randomness: False
  Random Seed: 42
================================================================================

ðŸ”„ LOADING DATASETS...
Dataset size: 5058
  - Data augmentation: ENABLED
æºåŸŸè®­ç»ƒé›†: 1264 batches (full dataset)
Total dataset size: 100
Training set size: 80
Validation set size: 20
ç›®æ ‡åŸŸè®­ç»ƒé›†: 20 batches
ç›®æ ‡åŸŸéªŒè¯é›†: 5 batches
æž„å»ºæ¨¡åž‹...
Learning Rate Scheduler configured:
  - Type: ReduceLROnPlateau (adaptive based on loss)
  - Patience (epochs to wait): 12
  - Decay Factor: 0.8
  - Minimum LR: 1e-7
Let's go!
Created save directory: models/thesis/gold/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_data_train_da
--------------------Epoch: 1/100--------------------
Learning Rate: 5e-05
2025-06-28 15:17:32.488560 Epoch [001/100], Step [0316/1264] (25%), Total Loss: 3.9194, Src Seg Loss: 1.2367, Tgt Seg Loss: 1.1407, Contrastive Loss: 0.2758, Domain Loss: 0.6700
2025-06-28 15:20:20.715071 Epoch [001/100], Step [0632/1264] (50%), Total Loss: 3.3488, Src Seg Loss: 1.2834, Tgt Seg Loss: 1.0239, Contrastive Loss: 0.1761, Domain Loss: 0.5291
2025-06-28 15:23:09.032843 Epoch [001/100], Step [0948/1264] (75%), Total Loss: 3.0030, Src Seg Loss: 1.0050, Tgt Seg Loss: 0.7072, Contrastive Loss: 0.0660, Domain Loss: 0.3728
2025-06-28 15:25:57.406123 Epoch [001/100], Step [1264/1264] (100%), Total Loss: 2.7144, Src Seg Loss: 0.8362, Tgt Seg Loss: 0.4597, Contrastive Loss: 0.0491, Domain Loss: 0.3373
Epoch 1 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.8461
  IoU: 0.1715
  F1-Score: 0.2928
  Precision: 0.4539
  Recall: 0.2161
  Accuracy: 0.9973
New best model saved! Validation loss: 0.8461
  Corresponding target validation IoU: 0.1715
--------------------Epoch: 2/100--------------------
Learning Rate: 5e-05
2025-06-28 15:28:48.531915 Epoch [002/100], Step [0316/1264] (25%), Total Loss: 2.6814, Src Seg Loss: 1.0947, Tgt Seg Loss: 0.3239, Contrastive Loss: 0.1696, Domain Loss: 0.3236
2025-06-28 15:31:36.987392 Epoch [002/100], Step [0632/1264] (50%), Total Loss: 2.6257, Src Seg Loss: 1.1833, Tgt Seg Loss: 0.2749, Contrastive Loss: 0.2594, Domain Loss: 0.2952
2025-06-28 15:34:25.420306 Epoch [002/100], Step [0948/1264] (75%), Total Loss: 2.4331, Src Seg Loss: 0.8479, Tgt Seg Loss: 0.2908, Contrastive Loss: 0.2024, Domain Loss: 0.2778
2025-06-28 15:37:13.587180 Epoch [002/100], Step [1264/1264] (100%), Total Loss: 2.3913, Src Seg Loss: 0.8519, Tgt Seg Loss: 0.2316, Contrastive Loss: 0.1244, Domain Loss: 0.2645
Epoch 2 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7751
  IoU: 0.1934
  F1-Score: 0.3241
  Precision: 0.3447
  Recall: 0.3058
  Accuracy: 0.9967
New best model saved! Validation loss: 0.7751
  Corresponding target validation IoU: 0.1934
--------------------Epoch: 3/100--------------------
Learning Rate: 5e-05
2025-06-28 15:40:03.771098 Epoch [003/100], Step [0316/1264] (25%), Total Loss: 2.4412, Src Seg Loss: 0.6618, Tgt Seg Loss: 0.1878, Contrastive Loss: 0.2701, Domain Loss: 0.3060
2025-06-28 15:42:52.975715 Epoch [003/100], Step [0632/1264] (50%), Total Loss: 2.3976, Src Seg Loss: 0.6654, Tgt Seg Loss: 0.1630, Contrastive Loss: 0.2263, Domain Loss: 0.3133
2025-06-28 15:45:41.378343 Epoch [003/100], Step [0948/1264] (75%), Total Loss: 2.3339, Src Seg Loss: 0.5996, Tgt Seg Loss: 0.1912, Contrastive Loss: 0.2629, Domain Loss: 0.4110
2025-06-28 15:48:29.771961 Epoch [003/100], Step [1264/1264] (100%), Total Loss: 2.4226, Src Seg Loss: 0.9677, Tgt Seg Loss: 0.1839, Contrastive Loss: 0.2726, Domain Loss: 0.2998
Epoch 3 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7384
  IoU: 0.1777
  F1-Score: 0.3018
  Precision: 0.2488
  Recall: 0.3835
  Accuracy: 0.9953
New best model saved! Validation loss: 0.7384
  Corresponding target validation IoU: 0.1777
--------------------Epoch: 4/100--------------------
Learning Rate: 5e-05
2025-06-28 15:51:20.231597 Epoch [004/100], Step [0316/1264] (25%), Total Loss: 2.4773, Src Seg Loss: 0.5715, Tgt Seg Loss: 0.1525, Contrastive Loss: 0.2548, Domain Loss: 0.4323
2025-06-28 15:54:09.450357 Epoch [004/100], Step [0632/1264] (50%), Total Loss: 2.4805, Src Seg Loss: 0.6015, Tgt Seg Loss: 0.1535, Contrastive Loss: 0.4077, Domain Loss: 0.3646
2025-06-28 15:56:58.837520 Epoch [004/100], Step [0948/1264] (75%), Total Loss: 2.4360, Src Seg Loss: 0.6538, Tgt Seg Loss: 0.1261, Contrastive Loss: 0.2974, Domain Loss: 0.3417
2025-06-28 15:59:49.354490 Epoch [004/100], Step [1264/1264] (100%), Total Loss: 2.2701, Src Seg Loss: 0.7955, Tgt Seg Loss: 0.1616, Contrastive Loss: 0.1927, Domain Loss: 0.4259
Epoch 4 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7233
  IoU: 0.1684
  F1-Score: 0.2883
  Precision: 0.2458
  Recall: 0.3484
  Accuracy: 0.9955
New best model saved! Validation loss: 0.7233
  Corresponding target validation IoU: 0.1684
--------------------Epoch: 5/100--------------------
Learning Rate: 5e-05
2025-06-28 16:02:39.477824 Epoch [005/100], Step [0316/1264] (25%), Total Loss: 2.2731, Src Seg Loss: 0.6498, Tgt Seg Loss: 0.1670, Contrastive Loss: 0.3658, Domain Loss: 0.4462
2025-06-28 16:05:27.550776 Epoch [005/100], Step [0632/1264] (50%), Total Loss: 2.2605, Src Seg Loss: 0.8278, Tgt Seg Loss: 0.1327, Contrastive Loss: 0.2847, Domain Loss: 0.5012
2025-06-28 16:08:16.439209 Epoch [005/100], Step [0948/1264] (75%), Total Loss: 2.4511, Src Seg Loss: 0.8498, Tgt Seg Loss: 0.1220, Contrastive Loss: 0.3808, Domain Loss: 0.4633
2025-06-28 16:11:05.412482 Epoch [005/100], Step [1264/1264] (100%), Total Loss: 2.4130, Src Seg Loss: 0.5124, Tgt Seg Loss: 0.1072, Contrastive Loss: 0.3391, Domain Loss: 0.4676
Epoch 5 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.6746
  IoU: 0.1766
  F1-Score: 0.3003
  Precision: 0.2263
  Recall: 0.4461
  Accuracy: 0.9945
New best model saved! Validation loss: 0.6746
  Corresponding target validation IoU: 0.1766
Checkpoint saved at epoch 5: checkpoint_epoch_005.pth
--------------------Epoch: 6/100--------------------
Learning Rate: 5e-05
2025-06-28 16:13:57.570997 Epoch [006/100], Step [0316/1264] (25%), Total Loss: 2.3143, Src Seg Loss: 0.8751, Tgt Seg Loss: 0.1265, Contrastive Loss: 0.1813, Domain Loss: 0.5207
2025-06-28 16:16:46.771287 Epoch [006/100], Step [0632/1264] (50%), Total Loss: 2.2591, Src Seg Loss: 0.6010, Tgt Seg Loss: 0.1532, Contrastive Loss: 0.1237, Domain Loss: 0.4890
2025-06-28 16:19:35.641042 Epoch [006/100], Step [0948/1264] (75%), Total Loss: 2.2626, Src Seg Loss: 0.5346, Tgt Seg Loss: 0.1123, Contrastive Loss: 0.1865, Domain Loss: 0.5303
2025-06-28 16:22:24.092712 Epoch [006/100], Step [1264/1264] (100%), Total Loss: 2.2970, Src Seg Loss: 0.5720, Tgt Seg Loss: 0.1138, Contrastive Loss: 0.2407, Domain Loss: 0.4648
Epoch 6 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7276
  IoU: 0.2414
  F1-Score: 0.3890
  Precision: 0.4220
  Recall: 0.3608
  Accuracy: 0.9970
--------------------Epoch: 7/100--------------------
Learning Rate: 5e-05
2025-06-28 16:25:14.369792 Epoch [007/100], Step [0316/1264] (25%), Total Loss: 2.2909, Src Seg Loss: 0.4039, Tgt Seg Loss: 0.1008, Contrastive Loss: 0.1629, Domain Loss: 0.5291
2025-06-28 16:28:03.089745 Epoch [007/100], Step [0632/1264] (50%), Total Loss: 2.3712, Src Seg Loss: 0.7369, Tgt Seg Loss: 0.1288, Contrastive Loss: 0.2095, Domain Loss: 0.5391
2025-06-28 16:30:52.980201 Epoch [007/100], Step [0948/1264] (75%), Total Loss: 2.3368, Src Seg Loss: 0.5118, Tgt Seg Loss: 0.1188, Contrastive Loss: 0.2619, Domain Loss: 0.5169
2025-06-28 16:33:41.913574 Epoch [007/100], Step [1264/1264] (100%), Total Loss: 2.3334, Src Seg Loss: 0.5920, Tgt Seg Loss: 0.1115, Contrastive Loss: 0.2381, Domain Loss: 0.5114
Epoch 7 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7019
  IoU: 0.2274
  F1-Score: 0.3706
  Precision: 0.3590
  Recall: 0.3829
  Accuracy: 0.9966
--------------------Epoch: 8/100--------------------
Learning Rate: 5e-05
2025-06-28 16:36:32.338643 Epoch [008/100], Step [0316/1264] (25%), Total Loss: 2.4534, Src Seg Loss: 0.3181, Tgt Seg Loss: 0.1090, Contrastive Loss: 0.3358, Domain Loss: 0.8139
2025-06-28 16:39:21.577943 Epoch [008/100], Step [0632/1264] (50%), Total Loss: 2.4125, Src Seg Loss: 0.4358, Tgt Seg Loss: 0.0893, Contrastive Loss: 0.3955, Domain Loss: 0.6189
2025-06-28 16:42:10.904056 Epoch [008/100], Step [0948/1264] (75%), Total Loss: 2.4326, Src Seg Loss: 0.5233, Tgt Seg Loss: 0.1165, Contrastive Loss: 0.4570, Domain Loss: 0.6292
2025-06-28 16:45:01.351448 Epoch [008/100], Step [1264/1264] (100%), Total Loss: 2.3674, Src Seg Loss: 0.4848, Tgt Seg Loss: 0.1128, Contrastive Loss: 0.2737, Domain Loss: 0.5420
Epoch 8 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7268
  IoU: 0.2226
  F1-Score: 0.3642
  Precision: 0.3535
  Recall: 0.3755
  Accuracy: 0.9966
--------------------Epoch: 9/100--------------------
Learning Rate: 5e-05
2025-06-28 16:47:51.973356 Epoch [009/100], Step [0316/1264] (25%), Total Loss: 2.4106, Src Seg Loss: 0.4367, Tgt Seg Loss: 0.1087, Contrastive Loss: 0.3280, Domain Loss: 0.6320
2025-06-28 16:50:40.537891 Epoch [009/100], Step [0632/1264] (50%), Total Loss: 2.5097, Src Seg Loss: 0.4274, Tgt Seg Loss: 0.1053, Contrastive Loss: 0.4914, Domain Loss: 0.7042
2025-06-28 16:53:29.063627 Epoch [009/100], Step [0948/1264] (75%), Total Loss: 2.4694, Src Seg Loss: 0.5247, Tgt Seg Loss: 0.0876, Contrastive Loss: 0.2731, Domain Loss: 0.5956
2025-06-28 16:56:17.526749 Epoch [009/100], Step [1264/1264] (100%), Total Loss: 2.5737, Src Seg Loss: 0.3591, Tgt Seg Loss: 0.1083, Contrastive Loss: 0.4452, Domain Loss: 0.6922
Epoch 9 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7393
  IoU: 0.2177
  F1-Score: 0.3575
  Precision: 0.3374
  Recall: 0.3802
  Accuracy: 0.9964
--------------------Epoch: 10/100--------------------
Learning Rate: 5e-05
2025-06-28 16:59:09.180619 Epoch [010/100], Step [0316/1264] (25%), Total Loss: 2.5789, Src Seg Loss: 0.3419, Tgt Seg Loss: 0.1115, Contrastive Loss: 0.3372, Domain Loss: 0.6440
2025-06-28 17:01:58.578026 Epoch [010/100], Step [0632/1264] (50%), Total Loss: 2.5626, Src Seg Loss: 0.3470, Tgt Seg Loss: 0.1014, Contrastive Loss: 0.4712, Domain Loss: 0.7350
2025-06-28 17:04:47.976588 Epoch [010/100], Step [0948/1264] (75%), Total Loss: 2.4639, Src Seg Loss: 0.4032, Tgt Seg Loss: 0.0940, Contrastive Loss: 0.2472, Domain Loss: 0.6732
2025-06-28 17:07:36.859441 Epoch [010/100], Step [1264/1264] (100%), Total Loss: 2.4977, Src Seg Loss: 0.4409, Tgt Seg Loss: 0.0873, Contrastive Loss: 0.2579, Domain Loss: 0.7277
Epoch 10 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7466
  IoU: 0.2180
  F1-Score: 0.3580
  Precision: 0.3634
  Recall: 0.3527
  Accuracy: 0.9967
Checkpoint saved at epoch 10: checkpoint_epoch_010.pth
--------------------Epoch: 11/100--------------------
Learning Rate: 5e-05
2025-06-28 17:10:27.481364 Epoch [011/100], Step [0316/1264] (25%), Total Loss: 2.4574, Src Seg Loss: 0.4257, Tgt Seg Loss: 0.1028, Contrastive Loss: 0.4564, Domain Loss: 0.7328
2025-06-28 17:13:16.350146 Epoch [011/100], Step [0632/1264] (50%), Total Loss: 2.4814, Src Seg Loss: 0.5031, Tgt Seg Loss: 0.0991, Contrastive Loss: 0.2726, Domain Loss: 0.5742
2025-06-28 17:16:05.569448 Epoch [011/100], Step [0948/1264] (75%), Total Loss: 2.5007, Src Seg Loss: 0.3662, Tgt Seg Loss: 0.1056, Contrastive Loss: 0.4093, Domain Loss: 0.6963
2025-06-28 17:18:53.764860 Epoch [011/100], Step [1264/1264] (100%), Total Loss: 2.4935, Src Seg Loss: 0.5273, Tgt Seg Loss: 0.1041, Contrastive Loss: 0.4252, Domain Loss: 0.6311
Epoch 11 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7003
  IoU: 0.2126
  F1-Score: 0.3506
  Precision: 0.3128
  Recall: 0.3988
  Accuracy: 0.9961
--------------------Epoch: 12/100--------------------
Learning Rate: 5e-05
2025-06-28 17:21:44.065686 Epoch [012/100], Step [0316/1264] (25%), Total Loss: 2.4694, Src Seg Loss: 0.4180, Tgt Seg Loss: 0.0825, Contrastive Loss: 0.3466, Domain Loss: 0.7660
2025-06-28 17:24:33.004687 Epoch [012/100], Step [0632/1264] (50%), Total Loss: 2.5447, Src Seg Loss: 0.5603, Tgt Seg Loss: 0.1075, Contrastive Loss: 0.4174, Domain Loss: 0.7170
2025-06-28 17:27:21.663739 Epoch [012/100], Step [0948/1264] (75%), Total Loss: 2.4756, Src Seg Loss: 0.5992, Tgt Seg Loss: 0.1045, Contrastive Loss: 0.3091, Domain Loss: 0.5459
2025-06-28 17:30:11.682975 Epoch [012/100], Step [1264/1264] (100%), Total Loss: 2.4507, Src Seg Loss: 0.3836, Tgt Seg Loss: 0.1045, Contrastive Loss: 0.4020, Domain Loss: 0.6767
Epoch 12 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7149
  IoU: 0.2164
  F1-Score: 0.3558
  Precision: 0.3496
  Recall: 0.3621
  Accuracy: 0.9966
--------------------Epoch: 13/100--------------------
Learning Rate: 5e-05
2025-06-28 17:33:02.299553 Epoch [013/100], Step [0316/1264] (25%), Total Loss: 2.5010, Src Seg Loss: 0.2651, Tgt Seg Loss: 0.0869, Contrastive Loss: 0.5140, Domain Loss: 0.6710
2025-06-28 17:35:51.006692 Epoch [013/100], Step [0632/1264] (50%), Total Loss: 2.4876, Src Seg Loss: 0.3756, Tgt Seg Loss: 0.0835, Contrastive Loss: 0.5042, Domain Loss: 0.6123
2025-06-28 17:38:39.756317 Epoch [013/100], Step [0948/1264] (75%), Total Loss: 2.5258, Src Seg Loss: 0.4118, Tgt Seg Loss: 0.1210, Contrastive Loss: 0.5306, Domain Loss: 0.6240
2025-06-28 17:41:28.236612 Epoch [013/100], Step [1264/1264] (100%), Total Loss: 2.4679, Src Seg Loss: 0.2198, Tgt Seg Loss: 0.0990, Contrastive Loss: 0.3306, Domain Loss: 0.6705
Epoch 13 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7200
  IoU: 0.2602
  F1-Score: 0.4129
  Precision: 0.4597
  Recall: 0.3748
  Accuracy: 0.9972
--------------------Epoch: 14/100--------------------
Learning Rate: 5e-05
2025-06-28 17:44:18.545199 Epoch [014/100], Step [0316/1264] (25%), Total Loss: 2.5065, Src Seg Loss: 0.4842, Tgt Seg Loss: 0.0931, Contrastive Loss: 0.3818, Domain Loss: 0.5709
2025-06-28 17:47:08.593790 Epoch [014/100], Step [0632/1264] (50%), Total Loss: 2.4868, Src Seg Loss: 0.4068, Tgt Seg Loss: 0.0804, Contrastive Loss: 0.4381, Domain Loss: 0.5895
2025-06-28 17:49:56.861888 Epoch [014/100], Step [0948/1264] (75%), Total Loss: 2.5261, Src Seg Loss: 0.3872, Tgt Seg Loss: 0.0865, Contrastive Loss: 0.4706, Domain Loss: 0.6071
2025-06-28 17:52:45.461279 Epoch [014/100], Step [1264/1264] (100%), Total Loss: 2.3282, Src Seg Loss: 0.3722, Tgt Seg Loss: 0.1027, Contrastive Loss: 0.3934, Domain Loss: 0.6502
Epoch 14 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.6960
  IoU: 0.2384
  F1-Score: 0.3850
  Precision: 0.3630
  Recall: 0.4099
  Accuracy: 0.9966
--------------------Epoch: 15/100--------------------
Learning Rate: 5e-05
2025-06-28 17:55:35.635155 Epoch [015/100], Step [0316/1264] (25%), Total Loss: 2.0402, Src Seg Loss: 0.5211, Tgt Seg Loss: 0.0944, Contrastive Loss: 0.0253, Domain Loss: 0.6373
2025-06-28 17:58:23.806855 Epoch [015/100], Step [0632/1264] (50%), Total Loss: 2.0846, Src Seg Loss: 0.3643, Tgt Seg Loss: 0.0963, Contrastive Loss: 0.0021, Domain Loss: 0.6620
2025-06-28 18:01:13.672638 Epoch [015/100], Step [0948/1264] (75%), Total Loss: 1.9985, Src Seg Loss: 0.4212, Tgt Seg Loss: 0.0798, Contrastive Loss: 0.0007, Domain Loss: 0.6739
2025-06-28 18:04:02.977107 Epoch [015/100], Step [1264/1264] (100%), Total Loss: 2.0380, Src Seg Loss: 0.4940, Tgt Seg Loss: 0.0739, Contrastive Loss: 0.0097, Domain Loss: 0.6363
Epoch 15 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.6856
  IoU: 0.2589
  F1-Score: 0.4114
  Precision: 0.4142
  Recall: 0.4085
  Accuracy: 0.9969
Checkpoint saved at epoch 15: checkpoint_epoch_015.pth
--------------------Epoch: 16/100--------------------
Learning Rate: 5e-05
2025-06-28 18:06:53.574601 Epoch [016/100], Step [0316/1264] (25%), Total Loss: 2.0655, Src Seg Loss: 0.5197, Tgt Seg Loss: 0.0921, Contrastive Loss: 0.0336, Domain Loss: 0.6506
2025-06-28 18:09:43.072517 Epoch [016/100], Step [0632/1264] (50%), Total Loss: 1.9685, Src Seg Loss: 0.2764, Tgt Seg Loss: 0.0965, Contrastive Loss: 0.0015, Domain Loss: 0.5842
2025-06-28 18:12:32.529164 Epoch [016/100], Step [0948/1264] (75%), Total Loss: 1.9970, Src Seg Loss: 0.4314, Tgt Seg Loss: 0.0943, Contrastive Loss: 0.0222, Domain Loss: 0.6111
2025-06-28 18:15:21.106982 Epoch [016/100], Step [1264/1264] (100%), Total Loss: 2.0053, Src Seg Loss: 0.3216, Tgt Seg Loss: 0.0839, Contrastive Loss: 0.0069, Domain Loss: 0.6493
Epoch 16 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.6789
  IoU: 0.2447
  F1-Score: 0.3931
  Precision: 0.3727
  Recall: 0.4159
  Accuracy: 0.9966
--------------------Epoch: 17/100--------------------
Learning Rate: 5e-05
2025-06-28 18:18:12.853651 Epoch [017/100], Step [0316/1264] (25%), Total Loss: 2.0071, Src Seg Loss: 0.2990, Tgt Seg Loss: 0.0712, Contrastive Loss: 0.0010, Domain Loss: 0.6914
2025-06-28 18:21:01.908153 Epoch [017/100], Step [0632/1264] (50%), Total Loss: 2.0296, Src Seg Loss: 0.2654, Tgt Seg Loss: 0.0951, Contrastive Loss: 0.0000, Domain Loss: 0.7145
2025-06-28 18:23:50.594547 Epoch [017/100], Step [0948/1264] (75%), Total Loss: 2.0041, Src Seg Loss: 0.2283, Tgt Seg Loss: 0.0934, Contrastive Loss: 0.0208, Domain Loss: 0.6195
2025-06-28 18:26:39.139832 Epoch [017/100], Step [1264/1264] (100%), Total Loss: 2.0270, Src Seg Loss: 0.2700, Tgt Seg Loss: 0.0849, Contrastive Loss: 0.0076, Domain Loss: 0.6408
Epoch 17 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7149
  IoU: 0.2521
  F1-Score: 0.4027
  Precision: 0.4090
  Recall: 0.3965
  Accuracy: 0.9969
--------------------Epoch: 18/100--------------------
Learning Rate: 5e-05
2025-06-28 18:29:29.332551 Epoch [018/100], Step [0316/1264] (25%), Total Loss: 2.0171, Src Seg Loss: 0.3404, Tgt Seg Loss: 0.0750, Contrastive Loss: 0.0028, Domain Loss: 0.6856
2025-06-28 18:32:19.506058 Epoch [018/100], Step [0632/1264] (50%), Total Loss: 1.9937, Src Seg Loss: 0.2122, Tgt Seg Loss: 0.0716, Contrastive Loss: 0.0007, Domain Loss: 0.7451
2025-06-28 18:35:08.354975 Epoch [018/100], Step [0948/1264] (75%), Total Loss: 2.0200, Src Seg Loss: 0.3412, Tgt Seg Loss: 0.0947, Contrastive Loss: 0.0291, Domain Loss: 0.6626
2025-06-28 18:37:56.836929 Epoch [018/100], Step [1264/1264] (100%), Total Loss: 2.0048, Src Seg Loss: 0.3115, Tgt Seg Loss: 0.0957, Contrastive Loss: 0.0042, Domain Loss: 0.5854
Epoch 18 completed. Learning rate: 0.000050
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7157
  IoU: 0.2131
  F1-Score: 0.3513
  Precision: 0.3225
  Recall: 0.3859
  Accuracy: 0.9963
Learning rate adjusted based on validation loss: 0.000050 -> 0.000040
--------------------Epoch: 19/100--------------------
Learning Rate: 4e-05
2025-06-28 18:40:47.158347 Epoch [019/100], Step [0316/1264] (25%), Total Loss: 1.9729, Src Seg Loss: 0.3770, Tgt Seg Loss: 0.0839, Contrastive Loss: 0.0246, Domain Loss: 0.6631
2025-06-28 18:43:35.666537 Epoch [019/100], Step [0632/1264] (50%), Total Loss: 1.9665, Src Seg Loss: 0.2847, Tgt Seg Loss: 0.0744, Contrastive Loss: 0.0000, Domain Loss: 0.6590
2025-06-28 18:46:24.890225 Epoch [019/100], Step [0948/1264] (75%), Total Loss: 1.9772, Src Seg Loss: 0.3313, Tgt Seg Loss: 0.0701, Contrastive Loss: 0.0879, Domain Loss: 0.7201
2025-06-28 18:49:15.191251 Epoch [019/100], Step [1264/1264] (100%), Total Loss: 1.9992, Src Seg Loss: 0.5350, Tgt Seg Loss: 0.0928, Contrastive Loss: 0.0270, Domain Loss: 0.6128
Epoch 19 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.6836
  IoU: 0.2761
  F1-Score: 0.4327
  Precision: 0.4533
  Recall: 0.4139
  Accuracy: 0.9972
--------------------Epoch: 20/100--------------------
Learning Rate: 4e-05
2025-06-28 18:52:05.780534 Epoch [020/100], Step [0316/1264] (25%), Total Loss: 2.0031, Src Seg Loss: 0.2534, Tgt Seg Loss: 0.0886, Contrastive Loss: 0.0447, Domain Loss: 0.6564
2025-06-28 18:54:54.804609 Epoch [020/100], Step [0632/1264] (50%), Total Loss: 2.0351, Src Seg Loss: 0.2390, Tgt Seg Loss: 0.0867, Contrastive Loss: 0.0704, Domain Loss: 0.7042
2025-06-28 18:57:43.681786 Epoch [020/100], Step [0948/1264] (75%), Total Loss: 1.9820, Src Seg Loss: 0.2549, Tgt Seg Loss: 0.0713, Contrastive Loss: 0.0412, Domain Loss: 0.6918
2025-06-28 19:00:32.766566 Epoch [020/100], Step [1264/1264] (100%), Total Loss: 1.9936, Src Seg Loss: 0.2896, Tgt Seg Loss: 0.0671, Contrastive Loss: 0.0253, Domain Loss: 0.7933
Epoch 20 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7352
  IoU: 0.2369
  F1-Score: 0.3830
  Precision: 0.4132
  Recall: 0.3569
  Accuracy: 0.9970
Checkpoint saved at epoch 20: checkpoint_epoch_020.pth
--------------------Epoch: 21/100--------------------
Learning Rate: 4e-05
2025-06-28 19:03:24.449959 Epoch [021/100], Step [0316/1264] (25%), Total Loss: 1.9570, Src Seg Loss: 0.3202, Tgt Seg Loss: 0.0998, Contrastive Loss: 0.0014, Domain Loss: 0.6707
2025-06-28 19:06:13.159422 Epoch [021/100], Step [0632/1264] (50%), Total Loss: 1.9426, Src Seg Loss: 0.3614, Tgt Seg Loss: 0.0941, Contrastive Loss: 0.0052, Domain Loss: 0.6184
2025-06-28 19:09:01.983628 Epoch [021/100], Step [0948/1264] (75%), Total Loss: 1.9737, Src Seg Loss: 0.2814, Tgt Seg Loss: 0.0846, Contrastive Loss: 0.0222, Domain Loss: 0.8085
2025-06-28 19:11:50.538442 Epoch [021/100], Step [1264/1264] (100%), Total Loss: 1.9963, Src Seg Loss: 0.1891, Tgt Seg Loss: 0.0728, Contrastive Loss: 0.0101, Domain Loss: 0.7219
Epoch 21 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7407
  IoU: 0.2257
  F1-Score: 0.3683
  Precision: 0.3738
  Recall: 0.3629
  Accuracy: 0.9967
--------------------Epoch: 22/100--------------------
Learning Rate: 4e-05
2025-06-28 19:14:40.509861 Epoch [022/100], Step [0316/1264] (25%), Total Loss: 1.9756, Src Seg Loss: 0.2523, Tgt Seg Loss: 0.0702, Contrastive Loss: 0.0114, Domain Loss: 0.6308
2025-06-28 19:17:29.357874 Epoch [022/100], Step [0632/1264] (50%), Total Loss: 1.9647, Src Seg Loss: 0.2122, Tgt Seg Loss: 0.1009, Contrastive Loss: 0.0863, Domain Loss: 0.6915
2025-06-28 19:20:19.372115 Epoch [022/100], Step [0948/1264] (75%), Total Loss: 1.9990, Src Seg Loss: 0.2513, Tgt Seg Loss: 0.0818, Contrastive Loss: 0.0128, Domain Loss: 0.6469
2025-06-28 19:23:08.097292 Epoch [022/100], Step [1264/1264] (100%), Total Loss: 2.0016, Src Seg Loss: 0.2823, Tgt Seg Loss: 0.0835, Contrastive Loss: 0.0740, Domain Loss: 0.7228
Epoch 22 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7152
  IoU: 0.2381
  F1-Score: 0.3846
  Precision: 0.3721
  Recall: 0.3980
  Accuracy: 0.9967
--------------------Epoch: 23/100--------------------
Learning Rate: 4e-05
2025-06-28 19:25:58.564460 Epoch [023/100], Step [0316/1264] (25%), Total Loss: 1.9759, Src Seg Loss: 0.3578, Tgt Seg Loss: 0.0737, Contrastive Loss: 0.0447, Domain Loss: 0.6640
2025-06-28 19:28:47.661279 Epoch [023/100], Step [0632/1264] (50%), Total Loss: 1.9605, Src Seg Loss: 0.2519, Tgt Seg Loss: 0.0676, Contrastive Loss: 0.0267, Domain Loss: 0.6981
2025-06-28 19:31:36.660951 Epoch [023/100], Step [0948/1264] (75%), Total Loss: 1.9741, Src Seg Loss: 0.1973, Tgt Seg Loss: 0.0899, Contrastive Loss: 0.0163, Domain Loss: 0.7534
2025-06-28 19:34:26.480210 Epoch [023/100], Step [1264/1264] (100%), Total Loss: 1.9312, Src Seg Loss: 0.2660, Tgt Seg Loss: 0.0856, Contrastive Loss: 0.0073, Domain Loss: 0.6133
Epoch 23 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7122
  IoU: 0.2087
  F1-Score: 0.3453
  Precision: 0.3126
  Recall: 0.3856
  Accuracy: 0.9962
--------------------Epoch: 24/100--------------------
Learning Rate: 4e-05
2025-06-28 19:37:16.805005 Epoch [024/100], Step [0316/1264] (25%), Total Loss: 1.9609, Src Seg Loss: 0.2473, Tgt Seg Loss: 0.0799, Contrastive Loss: 0.0107, Domain Loss: 0.7249
2025-06-28 19:40:06.220452 Epoch [024/100], Step [0632/1264] (50%), Total Loss: 1.8982, Src Seg Loss: 0.2450, Tgt Seg Loss: 0.0688, Contrastive Loss: 0.0135, Domain Loss: 0.6456
2025-06-28 19:42:55.233813 Epoch [024/100], Step [0948/1264] (75%), Total Loss: 1.9292, Src Seg Loss: 0.2764, Tgt Seg Loss: 0.0828, Contrastive Loss: 0.0347, Domain Loss: 0.6546
2025-06-28 19:45:44.027243 Epoch [024/100], Step [1264/1264] (100%), Total Loss: 1.9150, Src Seg Loss: 0.2720, Tgt Seg Loss: 0.0903, Contrastive Loss: 0.0121, Domain Loss: 0.6741
Epoch 24 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7161
  IoU: 0.2107
  F1-Score: 0.3480
  Precision: 0.3064
  Recall: 0.4026
  Accuracy: 0.9960
--------------------Epoch: 25/100--------------------
Learning Rate: 4e-05
2025-06-28 19:48:34.434671 Epoch [025/100], Step [0316/1264] (25%), Total Loss: 1.9169, Src Seg Loss: 0.2564, Tgt Seg Loss: 0.0820, Contrastive Loss: 0.0038, Domain Loss: 0.6030
2025-06-28 19:51:24.586270 Epoch [025/100], Step [0632/1264] (50%), Total Loss: 1.9464, Src Seg Loss: 0.3321, Tgt Seg Loss: 0.0811, Contrastive Loss: 0.0014, Domain Loss: 0.6680
2025-06-28 19:54:13.340545 Epoch [025/100], Step [0948/1264] (75%), Total Loss: 1.9418, Src Seg Loss: 0.3136, Tgt Seg Loss: 0.0683, Contrastive Loss: 0.0000, Domain Loss: 0.6568
2025-06-28 19:57:02.560107 Epoch [025/100], Step [1264/1264] (100%), Total Loss: 1.9369, Src Seg Loss: 0.3205, Tgt Seg Loss: 0.0677, Contrastive Loss: 0.0121, Domain Loss: 0.6778
Epoch 25 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7005
  IoU: 0.2067
  F1-Score: 0.3426
  Precision: 0.2998
  Recall: 0.3997
  Accuracy: 0.9960
Checkpoint saved at epoch 25: checkpoint_epoch_025.pth
--------------------Epoch: 26/100--------------------
Learning Rate: 4e-05
2025-06-28 19:59:53.143014 Epoch [026/100], Step [0316/1264] (25%), Total Loss: 1.9339, Src Seg Loss: 0.2300, Tgt Seg Loss: 0.0875, Contrastive Loss: 0.0180, Domain Loss: 0.6868
2025-06-28 20:02:42.700571 Epoch [026/100], Step [0632/1264] (50%), Total Loss: 1.9205, Src Seg Loss: 0.3195, Tgt Seg Loss: 0.0806, Contrastive Loss: 0.0038, Domain Loss: 0.6021
2025-06-28 20:05:31.769819 Epoch [026/100], Step [0948/1264] (75%), Total Loss: 1.9461, Src Seg Loss: 0.3835, Tgt Seg Loss: 0.0777, Contrastive Loss: 0.0135, Domain Loss: 0.6440
2025-06-28 20:08:23.162392 Epoch [026/100], Step [1264/1264] (100%), Total Loss: 1.9476, Src Seg Loss: 0.2063, Tgt Seg Loss: 0.0675, Contrastive Loss: 0.0055, Domain Loss: 0.6708
Epoch 26 completed. Learning rate: 0.000040
Starting validation on target domain...
Target Domain Validation Results (Reference Only) - Loss: 0.7129
  IoU: 0.2147
  F1-Score: 0.3535
  Precision: 0.3219
  Recall: 0.3919
  Accuracy: 0.9962
Early stopping triggered at epoch 26
Best validation loss: 0.6746 achieved at epoch 5

==================================================
Two-Domain Adaptive Training with Pseudo Labels completed!
Source Domain: SMOKE5K_Dataset_SMOKE5K_train (Ground Truth Labels - Full Dataset)
Target Domain: ijmond_data_train (Pseudo Labels)
Pseudo Label Weight: 0.5
Best training loss: 0.6746 achieved at epoch 5
Best model saved at: models/thesis/gold/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_data_train_da/SMOKE5K_Dataset_SMOKE5K_train_to_ijmond_data_train_da_best_model.pth
==================================================

JOB STATISTICS
==============
Job ID: 12700372
Cluster: snellius
User/Group: ytao/ytao
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 05:39:55
CPU Efficiency: 7.22% of 3-06:26:56 core-walltime
Job Wall-clock time: 04:54:11
Memory Utilized: 4.21 GB
Memory Efficiency: 5.26% of 80.00 GB (80.00 GB/node)
